"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[858],{858:(Re,b,m)=>{m.r(b),m.d(b,{AgentsModule:()=>Te});var c=m(6895),u=m(9158),l=m(4006),y=m(5226),S=m.n(y),e=m(4650),p=m(8386),d=m(9061),g=m(7185),f=m(9234);function I(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"option",34),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=i.$implicit;e.\u0275\u0275property("ngValue",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function E(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"span",41),e.\u0275\u0275text(1),e.\u0275\u0275element(2,"br"),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" Gardian : ",t.guardian_name||"-"," (",t.guardian_relation,") ")}}function w(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"span",42),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275propertyInterpolate1("routerLink","/agents/direct-ref/",t._id,""),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("Count: ",t.direct_ref_count,"")}}function D(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"span",42),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275propertyInterpolate1("routerLink","/agents/indirect-ref/",t._id,""),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("Count: ",t.indirect_ref_count,"")}}const _=function(a,i,t){return{"badge-soft-primary":a,"badge-soft-warning":i,"badge-soft-danger":t}};function k(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"a",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,_,"Approved"===(null==t||null==t.kyc[0]?null:t.kyc[0].status),"Requested"===(null==t||null==t.kyc[0]?null:t.kyc[0].status),"Rejected"===(null==t||null==t.kyc[0]?null:t.kyc[0].status))),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" KYC ",null==t||null==t.kyc[0]?null:t.kyc[0].status," ")}}function L(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"a",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,_,"Approved"===t.franchise_status,"Requested"===t.franchise_status,"Rejected"===t.franchise_status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Franchise ",t.franchise_status," ")}}function F(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",43),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext(),s=e.\u0275\u0275reference(73);return e.\u0275\u0275resetView(o.advisorModalFn(r,s))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,_,"Approved"===t.advisor_status,"Requested"===t.advisor_status,"Rejected"===t.advisor_status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Advisor ",t.advisor_status," ")}}function A(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ul",44)(1,"li",45),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext(),s=e.\u0275\u0275reference(75);return e.\u0275\u0275resetView(o.sendNotification(s,r))}),e.\u0275\u0275elementStart(2,"a",46),e.\u0275\u0275element(3,"i",47),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"li",48)(5,"a",49),e.\u0275\u0275element(6,"i",50),e.\u0275\u0275elementEnd()()()}if(2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate1("routerLink","/members/view/",t._id,"")}}const T=function(a,i,t,n){return{"badge-soft-primary":a,"badge-soft-warning":i,"badge-soft-danger":t,"badge-soft-secondary":n}};function R(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"tr")(1,"td"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"td"),e.\u0275\u0275text(4),e.\u0275\u0275element(5,"br"),e.\u0275\u0275template(6,E,3,2,"span",35),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"td"),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"td"),e.\u0275\u0275text(10),e.\u0275\u0275element(11,"br"),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"td"),e.\u0275\u0275template(14,w,2,2,"span",36),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"td"),e.\u0275\u0275template(16,D,2,2,"span",36),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"td"),e.\u0275\u0275text(18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"td"),e.\u0275\u0275text(20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"td"),e.\u0275\u0275text(22),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"td"),e.\u0275\u0275text(24),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"td"),e.\u0275\u0275text(26),e.\u0275\u0275pipe(27,"date"),e.\u0275\u0275element(28,"br"),e.\u0275\u0275text(29),e.\u0275\u0275pipe(30,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"td")(32,"a",37),e.\u0275\u0275text(33),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(34,k,2,6,"a",38),e.\u0275\u0275template(35,L,2,6,"a",38),e.\u0275\u0275template(36,F,2,6,"a",39),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"td"),e.\u0275\u0275template(38,A,7,1,"ul",40),e.\u0275\u0275elementEnd()()),2&a){const t=i.$implicit,n=i.index,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate((r.page-1)*r.pageSize+n+1),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.name," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.guardian_name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.user_id),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",null==t.referred_by[0]?null:t.referred_by[0].name," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",(null==t.referred_by[0]?null:t.referred_by[0].user_id)||"-"," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.direct_ref_count&&0!==t.direct_ref_count),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.indirect_ref_count&&0!==t.indirect_ref_count),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.account_number||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate((null==t||null==t.kyc[0]?null:t.kyc[0].aadhar)||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.gender||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.date_of_birth?r.getAge(t.date_of_birth):"-"," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" Joining : ",e.\u0275\u0275pipeBind1(27,20,t.created_date)," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" Approved : ",e.\u0275\u0275pipeBind1(30,22,t.approved_date)," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction4(24,T,"Active"===t.status,"Pending"===t.status,"Blocked"===t.status||"Deleted"===t.status,"Inactive"===t.status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Account ",t.status," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1==t.kyc.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.franchise_status),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.advisor_status),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","Deleted"!==t.status)}}function M(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"option",34),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=i.$implicit;e.\u0275\u0275property("ngValue",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function N(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",51)(1,"h5",52),e.\u0275\u0275text(2,"Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",53),e.\u0275\u0275listener("click",function(){const o=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(o.dismiss("Cross click"))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"div",54)(5,"div",2)(6,"div",55)(7,"div",56)(8,"label",57),e.\u0275\u0275text(9,"Change Status:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"select",58),e.\u0275\u0275listener("ngModelChange",function(r){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.currStatus=r)}),e.\u0275\u0275template(11,M,2,2,"option",16),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(12,"div",59)(13,"button",60),e.\u0275\u0275listener("click",function(){const o=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(o.close("Close click"))}),e.\u0275\u0275text(14,"Close"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"button",61),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.changeAdvisorStatus())}),e.\u0275\u0275text(16,"Submit"),e.\u0275\u0275elementEnd()()}if(2&a){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(10),e.\u0275\u0275property("ngModel",t.currStatus),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.kycStatusList)}}function G(a,i){1&a&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1,"Title is required."),e.\u0275\u0275elementEnd())}function V(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",67),e.\u0275\u0275template(1,G,2,0,"small",68),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);let n;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(n=t.notificationFormGroup.get("title"))||null==n.errors?null:n.errors.required)}}function O(a,i){1&a&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1,"Message is required."),e.\u0275\u0275elementEnd())}function U(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",67),e.\u0275\u0275template(1,O,2,0,"small",68),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);let n;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(n=t.notificationFormGroup.get("message"))||null==n.errors?null:n.errors.required)}}function z(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",51)(1,"h5",52),e.\u0275\u0275text(2,"Send Notification"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",53),e.\u0275\u0275listener("click",function(){const o=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(o.dismiss("Cross click"))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"form",7)(5,"div",54)(6,"div",2)(7,"div",55)(8,"div",56)(9,"label",57),e.\u0275\u0275text(10,"Title:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"input",62),e.\u0275\u0275template(12,V,2,1,"div",63),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",56)(14,"label",64),e.\u0275\u0275text(15,"Message:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(16,"textarea",65),e.\u0275\u0275template(17,U,2,1,"div",63),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(18,"div",59)(19,"button",60),e.\u0275\u0275listener("click",function(){const o=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(o.close("Close click"))}),e.\u0275\u0275text(20,"Close"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",66),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.sendMessage())}),e.\u0275\u0275text(22,"Send Message"),e.\u0275\u0275elementEnd()()()}if(2&a){const t=e.\u0275\u0275nextContext();let n,r;e.\u0275\u0275advance(4),e.\u0275\u0275property("formGroup",t.notificationFormGroup),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",(null==(n=t.notificationFormGroup.get("title"))?null:n.invalid)&&((null==(n=t.notificationFormGroup.get("title"))?null:n.dirty)||(null==(n=t.notificationFormGroup.get("title"))?null:n.touched))),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",(null==(r=t.notificationFormGroup.get("message"))?null:r.invalid)&&((null==(r=t.notificationFormGroup.get("message"))?null:r.dirty)||(null==(r=t.notificationFormGroup.get("message"))?null:r.touched))),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",t.notificationFormGroup.invalid)}}let j=(()=>{class a{constructor(t,n,r){this.userService=t,this.modalService=n,this.toast=r,this.currStatus="Pending",this.currUserId="",this.currKYCStatus="",this.statusList=["Pending","Active","Inactive","Blocked"],this.kycStatusList=["Requested","Approved","Rejected"],this.userList=[],this.total=0,this.page=1,this.pageSize=10}ngOnInit(){this.breadCrumbItems=[{label:"Advisor List"},{label:"User",active:!0}],this.notificationFormGroup=new l.cw({title:new l.NI("",l.kI.required),message:new l.NI("",l.kI.required)}),this.searchFormGroup=new l.cw({name:new l.NI(""),user_id:new l.NI(""),account_number:new l.NI(""),status:new l.NI("")}),this.getAllUsers()}search(){this.page=1,this.getAllUsers()}reset(){this.page=1,this.searchFormGroup.reset(),this.getAllUsers()}pageChange(t){this.page=t,this.getAllUsers()}getAllUsers(){const t=this.searchFormGroup.value,n=[];Object.keys(t).forEach(o=>{null!==t[o]&&""!==t[o]&&n.push(`${o}=${encodeURIComponent(t[o])}`)});const r=n.join("&");this.userService.getAllAdvisors(this.page,this.pageSize,r).subscribe(o=>{o&&o.data?(this.userList=o?.data?.users?.data||[],console.log("User List:",this.userList),this.total=o?.data?.users?.metadata[0]?.total||0):this.userList=[]},o=>{console.error("Error fetching user list:",o),this.userList=[]})}isTimePassed(t){return!!t&&(new Date).getTime()-new Date(t).getTime()>36e5}openModal(t){this.modalService.open(t)}getAge(t){const n=new Date,r=new Date(t);let o=n.getFullYear()-r.getFullYear();const s=n.getMonth()-r.getMonth();return(s<0||0===s&&n.getDate()<r.getDate())&&o--,o}addMember(t){}sendNotification(t,n){this.currUserId=n._id,this.openModal(t)}sendMessage(){if(this.notificationFormGroup.invalid)return void this.toast.error("Please fill all required fields");const{title:t,message:n}=this.notificationFormGroup.value;this.userService.sendNotification(this.currUserId,t,n).subscribe(r=>{r&&"success"===r.status?(this.toast.success("Notification sent successfully"),this.modalService.dismissAll(),this.notificationFormGroup.reset()):this.toast.error("Failed to send notification")},r=>{console.error("Error sending notification:",r),this.toast.error("Failed to send notification")})}findPageShowing(){return Math.min(this.page*this.pageSize,this.total)}advisorModalFn(t,n){"Requested"===t.advisor_status&&(this.currUserId=t._id,this.currStatus=t.advisor_status,this.openModal(n))}changeAdvisorStatus(){S().fire({title:"Are you sure?",text:`You want to ${this.currStatus} this advisor?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:`Yes, ${this.currStatus} it!`}).then(t=>{t.isConfirmed&&this.userService.updateProfile({_id:this.currUserId,advisor_status:this.currStatus,advisor_approved_date:new Date}).subscribe(n=>{this.modalService.dismissAll(),S().fire({title:"Success",text:`Advisor status changed to ${this.currStatus} successfully!`,icon:"success",confirmButtonText:"OK"}),this.toast.success(`Advisor status changed to ${this.currStatus} Successfully`),this.getAllUsers()},n=>{console.error("Error changing advisor status:",n),this.modalService.dismissAll(),this.toast.error("Failed to change advisor status")})})}}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(p.i),e.\u0275\u0275directiveInject(d.FF),e.\u0275\u0275directiveInject(g._W))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["app-agents"]],decls:76,vars:12,consts:[[1,"container-fluid"],["title","Advisors",3,"breadcrumbItems"],[1,"row"],[1,"col-xl-12"],[1,"card"],[1,"card-body"],[1,"card-body","border-bottom"],[3,"formGroup"],[1,"col-lg-3"],["type","search","id","searchInput","formControlName","name","placeholder","Search for Name...",1,"form-control"],["type","search","id","searchInput","formControlName","account_number","placeholder","Search for Account Number...",1,"form-control"],[1,"col-lg-2"],["type","search","id","searchInput","formControlName","user_id","placeholder","Search for User id...",1,"form-control"],["formControlName","status",1,"form-control","select2"],["value",""],["value","All"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-lg-1"],["type","button",1,"btn","btn-soft-secondary","w-100",3,"click"],[1,"mdi","mdi-filter-outline","align-middle"],["type","button",1,"btn","btn-light",3,"click"],[1,"mdi","mdi-refresh"],[1,"table-responsive"],["id","basic-datatable",1,"table","table-bordered","dt-responsive","nowrap","datatables","no-footer","dtr-inline"],[3,"width"],[4,"ngFor","ngForOf"],[1,"row","justify-content-md-between","align-items-md-center","mt-2"],[1,"col-sm-12","col-md-5"],["id","tickets-table_info","role","status","aria-live","polite",1,"dataTables_info","mb-2"],[1,"text-md-right","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","pageChange"],["role","document"],["changeAdvisorStatusModal",""],["messageModal",""],[3,"ngValue"],["class","text-muted",4,"ngIf"],["class","badge badge-soft-primary cursor-pointer",3,"routerLink",4,"ngIf"],["href","javascript: void(0);",1,"badge","font-size-11","m-1",3,"ngClass"],["href","javascript: void(0);","class","badge font-size-11 m-1",3,"ngClass",4,"ngIf"],["href","javascript: void(0);","class","badge font-size-11 m-1",3,"ngClass","click",4,"ngIf"],["class","list-inline font-size-20 contact-links mb-0",4,"ngIf"],[1,"text-muted"],[1,"badge","badge-soft-primary","cursor-pointer",3,"routerLink"],["href","javascript: void(0);",1,"badge","font-size-11","m-1",3,"ngClass","click"],[1,"list-inline","font-size-20","contact-links","mb-0"],["data-bs-toggle","modal","data-bs-target","#myModal",1,"list-inline-item","px-2",3,"click"],["href","javascript:void(0);","tooltip","Message"],[1,"bx","bx-message-square-dots"],[1,"list-inline-item","px-2"],["tooltip","Profile",3,"routerLink"],[1,"bx","bx-user-circle"],[1,"modal-header"],["id","myModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-md-12"],[1,"mb-3"],["for","recipient-name",1,"col-form-label"],["type","number",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary","waves-effect",3,"click"],["type","button",1,"btn","btn-primary","waves-effect","waves-light",3,"click"],["type","text","id","recipient-name","formControlName","title","placeholder","Enter Title",1,"form-control"],["class","text-danger mt-1",4,"ngIf"],["for","message-text",1,"col-form-label"],["id","message-text","formControlName","message","placeholder","Enter Message",1,"form-control"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled","click"],[1,"text-danger","mt-1"],[4,"ngIf"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275elementStart(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"form",7)(8,"div",2)(9,"div",8),e.\u0275\u0275element(10,"input",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",8),e.\u0275\u0275element(12,"input",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",11),e.\u0275\u0275element(14,"input",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"div",11)(16,"select",13)(17,"option",14),e.\u0275\u0275text(18,"Select Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"option",15),e.\u0275\u0275text(20,"All"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,I,2,2,"option",16),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",17)(23,"button",18),e.\u0275\u0275listener("click",function(){return n.search()}),e.\u0275\u0275element(24,"i",19),e.\u0275\u0275text(25," Filter"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(26,"div",17)(27,"button",20),e.\u0275\u0275listener("click",function(){return n.reset()}),e.\u0275\u0275element(28,"i",21),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(29,"div",2)(30,"div",22)(31,"table",23)(32,"thead")(33,"tr")(34,"th"),e.\u0275\u0275text(35,"Sr No"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"th"),e.\u0275\u0275text(37,"Name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"th"),e.\u0275\u0275text(39,"UserId"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(40,"th"),e.\u0275\u0275text(41,"Refer Id"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(42,"th"),e.\u0275\u0275text(43,"Direct Ref"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(44,"th"),e.\u0275\u0275text(45,"InDirect Ref"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"th"),e.\u0275\u0275text(47,"Account Number"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(48,"th"),e.\u0275\u0275text(49,"Aadhar Number"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(50,"th"),e.\u0275\u0275text(51,"Gender"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"th"),e.\u0275\u0275text(53,"Age"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(54,"th"),e.\u0275\u0275text(55,"Date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(56,"th",24),e.\u0275\u0275text(57,"Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"th",24),e.\u0275\u0275text(59,"Action"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(60,"tbody"),e.\u0275\u0275template(61,R,39,29,"tr",25),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(62,"div",26)(63,"div",27)(64,"div",28),e.\u0275\u0275text(65,"Showing "),e.\u0275\u0275elementStart(66,"b"),e.\u0275\u0275text(67),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(68),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(69,"div",27)(70,"div",29)(71,"ngb-pagination",30),e.\u0275\u0275listener("pageChange",function(o){return n.page=o})("pageChange",function(o){return n.pageChange(o)}),e.\u0275\u0275elementEnd()()()()()()()()()()(),e.\u0275\u0275template(72,N,17,2,"ng-template",31,32,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(74,z,23,4,"ng-template",31,33,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("breadcrumbItems",n.breadCrumbItems),e.\u0275\u0275advance(6),e.\u0275\u0275property("formGroup",n.searchFormGroup),e.\u0275\u0275advance(14),e.\u0275\u0275property("ngForOf",n.statusList),e.\u0275\u0275advance(35),e.\u0275\u0275property("width",10),e.\u0275\u0275advance(2),e.\u0275\u0275property("width",10),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",n.userList),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate((n.page-1)*n.pageSize+1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" to ",n.findPageShowing()," of ",n.total," entries "),e.\u0275\u0275advance(3),e.\u0275\u0275property("collectionSize",n.total)("page",n.page)("pageSize",n.pageSize))},dependencies:[c.NgClass,c.NgForOf,c.NgIf,f.V,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.On,d.N9,l.sg,l.u,u.rH,u.yS,c.DatePipe]}),a})();function $(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"option",30),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=i.$implicit;e.\u0275\u0275property("ngValue",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function B(a,i){1&a&&(e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275element(1,"img",32),e.\u0275\u0275elementStart(2,"p",33),e.\u0275\u0275text(3,"No Users Found in current filter."),e.\u0275\u0275elementEnd()())}function P(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"span",47),e.\u0275\u0275text(1),e.\u0275\u0275element(2,"br"),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" Gardian : ",t.guardian_name||"-"," (",t.guardian_relation,") ")}}const h=function(a,i,t){return{"badge-soft-primary":a,"badge-soft-warning":i,"badge-soft-danger":t}};function Y(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"a",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,h,"Approved"===(null==t||null==t.kyc[0]?null:t.kyc[0].status),"Requested"===(null==t||null==t.kyc[0]?null:t.kyc[0].status),"Rejected"===(null==t||null==t.kyc[0]?null:t.kyc[0].status))),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" KYC ",null==t||null==t.kyc[0]?null:t.kyc[0].status," ")}}function q(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"a",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,h,"Approved"===t.franchise_status,"Requested"===t.franchise_status,"Rejected"===t.franchise_status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Franchise ",t.franchise_status," ")}}function J(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"a",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,h,"Approved"===t.advisor_status,"Requested"===t.advisor_status,"Rejected"===t.advisor_status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Advisor ",t.advisor_status," ")}}function K(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ul",48)(1,"li",49),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext(2),s=e.\u0275\u0275reference(40);return e.\u0275\u0275resetView(o.sendNotification(s,r))}),e.\u0275\u0275elementStart(2,"a",50),e.\u0275\u0275element(3,"i",51),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"li",52)(5,"a",53),e.\u0275\u0275element(6,"i",54),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"li",52)(8,"a",53),e.\u0275\u0275element(9,"i",55),e.\u0275\u0275elementEnd()()()}if(2&a){const t=e.\u0275\u0275nextContext().$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate1("routerLink","/members/view/",t._id,""),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate2("routerLink","/agents/",n.currentUserId,"/income-statics/direct/",t._id,"")}}const W=function(a,i,t,n){return{"badge-soft-primary":a,"badge-soft-warning":i,"badge-soft-danger":t,"badge-soft-secondary":n}};function Q(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"tr")(1,"td"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"td"),e.\u0275\u0275text(4),e.\u0275\u0275element(5,"br"),e.\u0275\u0275template(6,P,3,2,"span",43),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"td"),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"td"),e.\u0275\u0275text(10),e.\u0275\u0275element(11,"br"),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"td")(14,"span")(15,"b"),e.\u0275\u0275text(16,"Member: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(17),e.\u0275\u0275element(18,"br"),e.\u0275\u0275elementStart(19,"b"),e.\u0275\u0275text(20,"Card: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(21),e.\u0275\u0275element(22,"br"),e.\u0275\u0275elementStart(23,"b"),e.\u0275\u0275text(24,"Loan: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"number"),e.\u0275\u0275element(27,"br"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"td"),e.\u0275\u0275text(29),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"td"),e.\u0275\u0275text(31),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"td"),e.\u0275\u0275text(33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(34,"td"),e.\u0275\u0275text(35),e.\u0275\u0275pipe(36,"date"),e.\u0275\u0275element(37,"br"),e.\u0275\u0275text(38),e.\u0275\u0275pipe(39,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(40,"td")(41,"a",44),e.\u0275\u0275text(42),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(43,Y,2,6,"a",45),e.\u0275\u0275template(44,q,2,6,"a",45),e.\u0275\u0275template(45,J,2,6,"a",45),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"td"),e.\u0275\u0275template(47,K,10,3,"ul",46),e.\u0275\u0275elementEnd()()),2&a){const t=i.$implicit,n=i.index,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate((r.page-1)*r.pageSize+n+1),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.name," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.guardian_name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.user_id),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",null==t.referred_by[0]?null:t.referred_by[0].name," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",(null==t.referred_by[0]?null:t.referred_by[0].user_id)||"-"," "),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" \u20b9",t.commission.direct||0," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" \u20b9",t.commission.cc_direct||0," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" \u20b9",e.\u0275\u0275pipeBind1(26,20,t.commission.loan_direct||0)," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(t.account_number||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.gender||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.date_of_birth?r.getAge(t.date_of_birth):"-"," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" Joining : ",e.\u0275\u0275pipeBind1(36,22,t.created_date)," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" Approved : ",e.\u0275\u0275pipeBind1(39,24,t.approved_date)," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction4(26,W,"Active"===t.status,"Pending"===t.status,"Blocked"===t.status||"Deleted"===t.status,"Inactive"===t.status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Account ",t.status," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1==t.kyc.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.franchise_status),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.advisor_status),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","Deleted"!==t.status)}}function X(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",34)(1,"table",35)(2,"thead")(3,"tr")(4,"th"),e.\u0275\u0275text(5,"Sr No"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"th"),e.\u0275\u0275text(7,"Name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"th"),e.\u0275\u0275text(9,"UserId"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"th"),e.\u0275\u0275text(11,"Refer Id"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"th"),e.\u0275\u0275text(13,"Commission"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"th"),e.\u0275\u0275text(15,"Account Number"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"th"),e.\u0275\u0275text(17,"Gender"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"th"),e.\u0275\u0275text(19,"Age"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"th"),e.\u0275\u0275text(21,"Date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"th",36),e.\u0275\u0275text(23,"Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"th",36),e.\u0275\u0275text(25,"Action"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(26,"tbody"),e.\u0275\u0275template(27,Q,48,31,"tr",37),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"div",38)(29,"div",39)(30,"div",40),e.\u0275\u0275text(31,"Showing "),e.\u0275\u0275elementStart(32,"b"),e.\u0275\u0275text(33),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(34),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(35,"div",39)(36,"div",41)(37,"ngb-pagination",42),e.\u0275\u0275listener("pageChange",function(r){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.page=r)})("pageChange",function(r){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.pageChange(r))}),e.\u0275\u0275elementEnd()()()()()}if(2&a){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(22),e.\u0275\u0275property("width",10),e.\u0275\u0275advance(2),e.\u0275\u0275property("width",10),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.userList),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate((t.page-1)*t.pageSize+1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" to ",t.findPageShowing()," of ",t.total," entries "),e.\u0275\u0275advance(3),e.\u0275\u0275property("collectionSize",t.total)("page",t.page)("pageSize",t.pageSize)}}function H(a,i){1&a&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1,"Title is required."),e.\u0275\u0275elementEnd())}function Z(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",70),e.\u0275\u0275template(1,H,2,0,"small",71),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);let n;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(n=t.notificationFormGroup.get("title"))||null==n.errors?null:n.errors.required)}}function ee(a,i){1&a&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1,"Message is required."),e.\u0275\u0275elementEnd())}function te(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",70),e.\u0275\u0275template(1,ee,2,0,"small",71),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);let n;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(n=t.notificationFormGroup.get("message"))||null==n.errors?null:n.errors.required)}}function ne(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",56)(1,"h5",57),e.\u0275\u0275text(2,"Send Notification"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",58),e.\u0275\u0275listener("click",function(){const o=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(o.dismiss("Cross click"))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"form",11)(5,"div",59)(6,"div",2)(7,"div",60)(8,"div",61)(9,"label",62),e.\u0275\u0275text(10,"Title:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"input",63),e.\u0275\u0275template(12,Z,2,1,"div",64),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",61)(14,"label",65),e.\u0275\u0275text(15,"Message:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(16,"textarea",66),e.\u0275\u0275template(17,te,2,1,"div",64),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(18,"div",67)(19,"button",68),e.\u0275\u0275listener("click",function(){const o=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(o.close("Close click"))}),e.\u0275\u0275text(20,"Close"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",69),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.sendMessage())}),e.\u0275\u0275text(22,"Send Message"),e.\u0275\u0275elementEnd()()()}if(2&a){const t=e.\u0275\u0275nextContext();let n,r;e.\u0275\u0275advance(4),e.\u0275\u0275property("formGroup",t.notificationFormGroup),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",(null==(n=t.notificationFormGroup.get("title"))?null:n.invalid)&&((null==(n=t.notificationFormGroup.get("title"))?null:n.dirty)||(null==(n=t.notificationFormGroup.get("title"))?null:n.touched))),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",(null==(r=t.notificationFormGroup.get("message"))?null:r.invalid)&&((null==(r=t.notificationFormGroup.get("message"))?null:r.dirty)||(null==(r=t.notificationFormGroup.get("message"))?null:r.touched))),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",t.notificationFormGroup.invalid)}}let ae=(()=>{class a{constructor(t,n,r,o){this.toast=t,this.userService=n,this.modalService=r,this.route=o,this.currStatus="Pending",this.totalDirectCommission=0,this.currUserId="",this.currKYCStatus="",this.currentUserId="",this.statusList=["Pending","Active","Inactive","Blocked"],this.kycStatusList=["Requested","Approved","Rejected"],this.userList=[],this.total=0,this.page=1,this.pageSize=10}ngOnInit(){this.breadCrumbItems=[{label:"Advisor List"},{label:"User",url:"/agents"},{label:"Direct Reference",active:!0}],this.notificationFormGroup=new l.cw({title:new l.NI("",l.kI.required),message:new l.NI("",l.kI.required)}),this.searchFormGroup=new l.cw({name:new l.NI(""),user_id:new l.NI(""),account_number:new l.NI(""),status:new l.NI("")}),this.route.params.subscribe(t=>{this.currentUserId=t.id,this.getDiretRefUsers(this.currentUserId)})}search(){this.page=1,this.getDiretRefUsers()}reset(){this.page=1,this.searchFormGroup.reset(),this.getDiretRefUsers()}pageChange(t){this.page=t,this.getDiretRefUsers()}getDiretRefUsers(t=this.currentUserId){const n=this.searchFormGroup.value,r=[];Object.keys(n).forEach(s=>{null!==n[s]&&""!==n[s]&&r.push(`${s}=${encodeURIComponent(n[s])}`)});const o=r.join("&");this.userService.getDirectRefUsers(this.page,this.pageSize,o,t).subscribe(s=>{console.log(s),s&&s.data?(this.userList=s?.data?.users||[],this.total=s?.data?.total||0,this.totalDirectCommission=s?.data?.commissionSummary?.totalCommission||0):this.userList=[]},s=>{console.error("Error fetching user list:",s),this.userList=[]})}isTimePassed(t){return!!t&&(new Date).getTime()-new Date(t).getTime()>36e5}openModal(t){this.modalService.open(t)}getAge(t){const n=new Date,r=new Date(t);let o=n.getFullYear()-r.getFullYear();const s=n.getMonth()-r.getMonth();return(s<0||0===s&&n.getDate()<r.getDate())&&o--,o}addMember(t){}sendNotification(t,n){this.currUserId=n._id,this.openModal(t)}sendMessage(){if(this.notificationFormGroup.invalid)return void this.toast.error("Please fill all required fields");const{title:t,message:n}=this.notificationFormGroup.value;this.userService.sendNotification(this.currUserId,t,n).subscribe(r=>{r&&"success"===r.status?(this.toast.success("Notification sent successfully"),this.modalService.dismissAll(),this.notificationFormGroup.reset()):this.toast.error("Failed to send notification")},r=>{console.error("Error sending notification:",r),this.toast.error("Failed to send notification")})}findPageShowing(){return Math.min(this.page*this.pageSize,this.total)}}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(g._W),e.\u0275\u0275directiveInject(p.i),e.\u0275\u0275directiveInject(d.FF),e.\u0275\u0275directiveInject(u.gz))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["app-diref-refernce-list"]],decls:41,vars:9,consts:[[1,"container-fluid"],["title","Direct Reference Users",3,"breadcrumbItems"],[1,"row"],[1,"col-xl-12"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"card-title","mb-0"],[1,"bg-soft-success","px-3","py-2","rounded"],[1,"mb-0"],[1,"card-body","border-bottom"],[3,"formGroup"],[1,"col-lg-3"],["type","search","id","searchInput","formControlName","name","placeholder","Search for Name...",1,"form-control"],["type","search","id","searchInput","formControlName","account_number","placeholder","Search for Account Number...",1,"form-control"],[1,"col-lg-2"],["type","search","id","searchInput","formControlName","user_id","placeholder","Search for User id...",1,"form-control"],["formControlName","status",1,"form-control","select2"],["value",""],["value","All"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-lg-1"],["type","button",1,"btn","btn-soft-secondary","w-100",3,"click"],[1,"mdi","mdi-filter-outline","align-middle"],["type","button",1,"btn","btn-light",3,"click"],[1,"mdi","mdi-refresh"],["class","d-flex flex-column justify-content-center align-items-center","style","min-height: 150px;",4,"ngIf"],["class","table-responsive",4,"ngIf"],["role","document"],["messageModal",""],[3,"ngValue"],[1,"d-flex","flex-column","justify-content-center","align-items-center",2,"min-height","150px"],["src","assets/img/not-found.png","width","300px","alt",""],[1,"text-mutes","mt-2"],[1,"table-responsive"],["id","basic-datatable",1,"table","table-bordered","dt-responsive","nowrap","datatables","no-footer","dtr-inline"],[3,"width"],[4,"ngFor","ngForOf"],[1,"row","justify-content-md-between","align-items-md-center","mt-2"],[1,"col-sm-12","col-md-5"],["id","tickets-table_info","role","status","aria-live","polite",1,"dataTables_info","mb-2"],[1,"text-md-right","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","pageChange"],["class","text-muted",4,"ngIf"],["href","javascript: void(0);",1,"badge","font-size-11","m-1",3,"ngClass"],["href","javascript: void(0);","class","badge font-size-11 m-1",3,"ngClass",4,"ngIf"],["class","list-inline font-size-20 contact-links mb-0",4,"ngIf"],[1,"text-muted"],[1,"list-inline","font-size-20","contact-links","mb-0"],["data-bs-toggle","modal","data-bs-target","#myModal",1,"list-inline-item","px-2",3,"click"],["href","javascript:void(0);","tooltip","Message"],[1,"bx","bx-message-square-dots"],[1,"list-inline-item","px-2"],["tooltip","Profile",3,"routerLink"],[1,"bx","bx-user-circle"],[1,"bx","bx-bar-chart"],[1,"modal-header"],["id","myModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-md-12"],[1,"mb-3"],["for","recipient-name",1,"col-form-label"],["type","text","id","recipient-name","formControlName","title","placeholder","Enter Title",1,"form-control"],["class","text-danger mt-1",4,"ngIf"],["for","message-text",1,"col-form-label"],["id","message-text","formControlName","message","placeholder","Enter Message",1,"form-control"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary","waves-effect",3,"click"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled","click"],[1,"text-danger","mt-1"],[4,"ngIf"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275elementStart(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h4",7),e.\u0275\u0275text(8,"Direct Reference List"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div",8)(10,"h5",9),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"number"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(13,"div",10)(14,"form",11)(15,"div",2)(16,"div",12),e.\u0275\u0275element(17,"input",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",12),e.\u0275\u0275element(19,"input",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",15),e.\u0275\u0275element(21,"input",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"div",15)(23,"select",17)(24,"option",18),e.\u0275\u0275text(25,"Select Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"option",19),e.\u0275\u0275text(27,"All"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(28,$,2,2,"option",20),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(29,"div",21)(30,"button",22),e.\u0275\u0275listener("click",function(){return n.search()}),e.\u0275\u0275element(31,"i",23),e.\u0275\u0275text(32," Filter"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(33,"div",21)(34,"button",24),e.\u0275\u0275listener("click",function(){return n.reset()}),e.\u0275\u0275element(35,"i",25),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(36,"div",2),e.\u0275\u0275template(37,B,4,0,"div",26),e.\u0275\u0275template(38,X,38,9,"div",27),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275template(39,ne,23,4,"ng-template",28,29,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("breadcrumbItems",n.breadCrumbItems),e.\u0275\u0275advance(10),e.\u0275\u0275textInterpolate1("Total Commission: \u20b9",e.\u0275\u0275pipeBind2(12,6,n.totalDirectCommission,"1.2-2"),""),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",n.searchFormGroup),e.\u0275\u0275advance(14),e.\u0275\u0275property("ngForOf",n.statusList),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngIf",!n.userList||0===n.userList.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.userList&&n.userList.length>0))},dependencies:[c.NgClass,c.NgForOf,c.NgIf,f.V,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,d.N9,l.sg,l.u,u.yS,c.DecimalPipe,c.DatePipe]}),a})();function re(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"option",30),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=i.$implicit;e.\u0275\u0275property("ngValue",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function ie(a,i){1&a&&(e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275element(1,"img",32),e.\u0275\u0275elementStart(2,"p",33),e.\u0275\u0275text(3,"No Users Found in current filter."),e.\u0275\u0275elementEnd()())}function oe(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"span",47),e.\u0275\u0275text(1),e.\u0275\u0275element(2,"br"),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" Gardian : ",t.guardian_name||"-"," (",t.guardian_relation,") ")}}const v=function(a,i,t){return{"badge-soft-primary":a,"badge-soft-warning":i,"badge-soft-danger":t}};function le(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"a",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,v,"Approved"===(null==t||null==t.kyc[0]?null:t.kyc[0].status),"Requested"===(null==t||null==t.kyc[0]?null:t.kyc[0].status),"Rejected"===(null==t||null==t.kyc[0]?null:t.kyc[0].status))),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" KYC ",null==t||null==t.kyc[0]?null:t.kyc[0].status," ")}}function se(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"a",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,v,"Approved"===t.franchise_status,"Requested"===t.franchise_status,"Rejected"===t.franchise_status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Franchise ",t.franchise_status," ")}}function ce(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"a",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,v,"Approved"===t.advisor_status,"Requested"===t.advisor_status,"Rejected"===t.advisor_status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Advisor ",t.advisor_status," ")}}function me(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ul",48)(1,"li",49),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext(2),s=e.\u0275\u0275reference(40);return e.\u0275\u0275resetView(o.sendNotification(s,r))}),e.\u0275\u0275elementStart(2,"a",50),e.\u0275\u0275element(3,"i",51),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"li",52)(5,"a",53),e.\u0275\u0275element(6,"i",54),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"li",52)(8,"a",53),e.\u0275\u0275element(9,"i",55),e.\u0275\u0275elementEnd()()()}if(2&a){const t=e.\u0275\u0275nextContext().$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate1("routerLink","/members/view/",t._id,""),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate2("routerLink","/agents/",n.currentUserId,"/income-statics/direct/",t._id,"")}}const de=function(a,i,t,n){return{"badge-soft-primary":a,"badge-soft-warning":i,"badge-soft-danger":t,"badge-soft-secondary":n}};function ue(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"tr")(1,"td"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"td"),e.\u0275\u0275text(4),e.\u0275\u0275element(5,"br"),e.\u0275\u0275template(6,oe,3,2,"span",43),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"td"),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"td"),e.\u0275\u0275text(10),e.\u0275\u0275element(11,"br"),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"td")(14,"span")(15,"b"),e.\u0275\u0275text(16,"Member: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(17),e.\u0275\u0275element(18,"br"),e.\u0275\u0275elementStart(19,"b"),e.\u0275\u0275text(20,"Card: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(21),e.\u0275\u0275element(22,"br"),e.\u0275\u0275elementStart(23,"b"),e.\u0275\u0275text(24,"Loan: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"number"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(27,"td"),e.\u0275\u0275text(28),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"td"),e.\u0275\u0275text(30),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"td"),e.\u0275\u0275text(32),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"td"),e.\u0275\u0275text(34),e.\u0275\u0275pipe(35,"date"),e.\u0275\u0275element(36,"br"),e.\u0275\u0275text(37),e.\u0275\u0275pipe(38,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(39,"td")(40,"a",44),e.\u0275\u0275text(41),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(42,le,2,6,"a",45),e.\u0275\u0275template(43,se,2,6,"a",45),e.\u0275\u0275template(44,ce,2,6,"a",45),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"td"),e.\u0275\u0275template(46,me,10,3,"ul",46),e.\u0275\u0275elementEnd()()),2&a){const t=i.$implicit,n=i.index,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate((r.page-1)*r.pageSize+n+1),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.name," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.guardian_name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.user_id),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",null==t.referred_by[0]?null:t.referred_by[0].name," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",(null==t.referred_by[0]?null:t.referred_by[0].user_id)||"-"," "),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" \u20b9",t.commission.indirect||0," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" \u20b9",t.commission.cc_indirect||0," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" \u20b9",e.\u0275\u0275pipeBind1(26,20,t.commission.loan_indirect||0)," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.account_number||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.gender||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.date_of_birth?r.getAge(t.date_of_birth):"-"," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" Joining : ",e.\u0275\u0275pipeBind1(35,22,t.created_date)," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" Approved : ",e.\u0275\u0275pipeBind1(38,24,t.approved_date)," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction4(26,de,"Active"===t.status,"Pending"===t.status,"Blocked"===t.status||"Deleted"===t.status,"Inactive"===t.status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Account ",t.status," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1==t.kyc.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.franchise_status),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.advisor_status),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","Deleted"!==t.status)}}function pe(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",34)(1,"table",35)(2,"thead")(3,"tr")(4,"th"),e.\u0275\u0275text(5,"Sr No"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"th"),e.\u0275\u0275text(7,"Name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"th"),e.\u0275\u0275text(9,"UserId"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"th"),e.\u0275\u0275text(11,"Refer Id"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"th"),e.\u0275\u0275text(13,"Commission"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"th"),e.\u0275\u0275text(15,"Account Number"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"th"),e.\u0275\u0275text(17,"Gender"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"th"),e.\u0275\u0275text(19,"Age"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"th"),e.\u0275\u0275text(21,"Date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"th",36),e.\u0275\u0275text(23,"Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"th",36),e.\u0275\u0275text(25,"Action"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(26,"tbody"),e.\u0275\u0275template(27,ue,47,31,"tr",37),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"div",38)(29,"div",39)(30,"div",40),e.\u0275\u0275text(31,"Showing "),e.\u0275\u0275elementStart(32,"b"),e.\u0275\u0275text(33),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(34),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(35,"div",39)(36,"div",41)(37,"ngb-pagination",42),e.\u0275\u0275listener("pageChange",function(r){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.page=r)})("pageChange",function(r){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.pageChange(r))}),e.\u0275\u0275elementEnd()()()()()}if(2&a){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(22),e.\u0275\u0275property("width",10),e.\u0275\u0275advance(2),e.\u0275\u0275property("width",10),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.userList),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate((t.page-1)*t.pageSize+1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" to ",t.findPageShowing()," of ",t.total," entries "),e.\u0275\u0275advance(3),e.\u0275\u0275property("collectionSize",t.total)("page",t.page)("pageSize",t.pageSize)}}function fe(a,i){1&a&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1,"Title is required."),e.\u0275\u0275elementEnd())}function ge(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",70),e.\u0275\u0275template(1,fe,2,0,"small",71),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);let n;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(n=t.notificationFormGroup.get("title"))||null==n.errors?null:n.errors.required)}}function _e(a,i){1&a&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1,"Message is required."),e.\u0275\u0275elementEnd())}function he(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",70),e.\u0275\u0275template(1,_e,2,0,"small",71),e.\u0275\u0275elementEnd()),2&a){const t=e.\u0275\u0275nextContext(2);let n;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(n=t.notificationFormGroup.get("message"))||null==n.errors?null:n.errors.required)}}function ve(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",56)(1,"h5",57),e.\u0275\u0275text(2,"Send Notification"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",58),e.\u0275\u0275listener("click",function(){const o=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(o.dismiss("Cross click"))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"form",11)(5,"div",59)(6,"div",2)(7,"div",60)(8,"div",61)(9,"label",62),e.\u0275\u0275text(10,"Title:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"input",63),e.\u0275\u0275template(12,ge,2,1,"div",64),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",61)(14,"label",65),e.\u0275\u0275text(15,"Message:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(16,"textarea",66),e.\u0275\u0275template(17,he,2,1,"div",64),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(18,"div",67)(19,"button",68),e.\u0275\u0275listener("click",function(){const o=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(o.close("Close click"))}),e.\u0275\u0275text(20,"Close"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",69),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.sendMessage())}),e.\u0275\u0275text(22,"Send Message"),e.\u0275\u0275elementEnd()()()}if(2&a){const t=e.\u0275\u0275nextContext();let n,r;e.\u0275\u0275advance(4),e.\u0275\u0275property("formGroup",t.notificationFormGroup),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",(null==(n=t.notificationFormGroup.get("title"))?null:n.invalid)&&((null==(n=t.notificationFormGroup.get("title"))?null:n.dirty)||(null==(n=t.notificationFormGroup.get("title"))?null:n.touched))),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",(null==(r=t.notificationFormGroup.get("message"))?null:r.invalid)&&((null==(r=t.notificationFormGroup.get("message"))?null:r.dirty)||(null==(r=t.notificationFormGroup.get("message"))?null:r.touched))),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",t.notificationFormGroup.invalid)}}let xe=(()=>{class a{constructor(t,n,r,o){this.toast=t,this.userService=n,this.modalService=r,this.route=o,this.currStatus="Pending",this.currUserId="",this.currKYCStatus="",this.currentUserId="",this.statusList=["Pending","Active","Inactive","Blocked"],this.kycStatusList=["Requested","Approved","Rejected"],this.userList=[],this.total=0,this.page=1,this.pageSize=10,this.totalIndirectCommission=0}ngOnInit(){this.breadCrumbItems=[{label:"Advisor List"},{label:"User",url:"/agents"},{label:"InDirect Reference",active:!0}],this.notificationFormGroup=new l.cw({title:new l.NI("",l.kI.required),message:new l.NI("",l.kI.required)}),this.searchFormGroup=new l.cw({name:new l.NI(""),user_id:new l.NI(""),account_number:new l.NI(""),status:new l.NI("")}),this.route.params.subscribe(t=>{this.currentUserId=t.id,console.log("Current User ID:",this.currentUserId),this.getInDiretRefUsers(this.currentUserId)})}search(){this.page=1,this.getInDiretRefUsers()}reset(){this.page=1,this.searchFormGroup.reset(),this.getInDiretRefUsers()}pageChange(t){this.page=t,this.getInDiretRefUsers()}getInDiretRefUsers(t=this.currentUserId){const n=this.searchFormGroup.value,r=[];Object.keys(n).forEach(s=>{null!==n[s]&&""!==n[s]&&r.push(`${s}=${encodeURIComponent(n[s])}`)});const o=r.join("&");this.userService.getInDirectRefUsers(this.page,this.pageSize,o,t).subscribe(s=>{s&&s.data?(this.userList=s?.data?.users||[],this.totalIndirectCommission=s?.data?.commissionSummary?.totalCommission||0,this.total=s?.data?.total||0):this.userList=[]},s=>{console.error("Error fetching user list:",s),this.userList=[]})}isTimePassed(t){return!!t&&(new Date).getTime()-new Date(t).getTime()>36e5}openModal(t){this.modalService.open(t)}getAge(t){const n=new Date,r=new Date(t);let o=n.getFullYear()-r.getFullYear();const s=n.getMonth()-r.getMonth();return(s<0||0===s&&n.getDate()<r.getDate())&&o--,o}addMember(t){}sendNotification(t,n){this.currUserId=n._id,this.openModal(t)}sendMessage(){if(this.notificationFormGroup.invalid)return void this.toast.error("Please fill all required fields");const{title:t,message:n}=this.notificationFormGroup.value;this.userService.sendNotification(this.currUserId,t,n).subscribe(r=>{r&&"success"===r.status?(this.toast.success("Notification sent successfully"),this.modalService.dismissAll(),this.notificationFormGroup.reset()):this.toast.error("Failed to send notification")},r=>{console.error("Error sending notification:",r),this.toast.error("Failed to send notification")})}findPageShowing(){return Math.min(this.page*this.pageSize,this.total)}}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(g._W),e.\u0275\u0275directiveInject(p.i),e.\u0275\u0275directiveInject(d.FF),e.\u0275\u0275directiveInject(u.gz))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["app-indiref-refernce-list"]],decls:41,vars:9,consts:[[1,"container-fluid"],["title","InDirect Reference Users",3,"breadcrumbItems"],[1,"row"],[1,"col-xl-12"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"card-title","mb-0"],[1,"bg-soft-success","px-3","py-2","rounded"],[1,"mb-0"],[1,"card-body","border-bottom"],[3,"formGroup"],[1,"col-lg-3"],["type","search","id","searchInput","formControlName","name","placeholder","Search for Name...",1,"form-control"],["type","search","id","searchInput","formControlName","account_number","placeholder","Search for Account Number...",1,"form-control"],[1,"col-lg-2"],["type","search","id","searchInput","formControlName","user_id","placeholder","Search for User id...",1,"form-control"],["formControlName","status",1,"form-control","select2"],["value",""],["value","All"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-lg-1"],["type","button",1,"btn","btn-soft-secondary","w-100",3,"click"],[1,"mdi","mdi-filter-outline","align-middle"],["type","button",1,"btn","btn-light",3,"click"],[1,"mdi","mdi-refresh"],["class","d-flex flex-column justify-content-center align-items-center","style","min-height: 150px;",4,"ngIf"],["class","table-responsive",4,"ngIf"],["role","document"],["messageModal",""],[3,"ngValue"],[1,"d-flex","flex-column","justify-content-center","align-items-center",2,"min-height","150px"],["src","assets/img/not-found.png","width","300px","alt",""],[1,"text-mutes","mt-2"],[1,"table-responsive"],["id","basic-datatable",1,"table","table-bordered","dt-responsive","nowrap","datatables","no-footer","dtr-inline"],[3,"width"],[4,"ngFor","ngForOf"],[1,"row","justify-content-md-between","align-items-md-center","mt-2"],[1,"col-sm-12","col-md-5"],["id","tickets-table_info","role","status","aria-live","polite",1,"dataTables_info","mb-2"],[1,"text-md-right","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","pageChange"],["class","text-muted",4,"ngIf"],["href","javascript: void(0);",1,"badge","font-size-11","m-1",3,"ngClass"],["href","javascript: void(0);","class","badge font-size-11 m-1",3,"ngClass",4,"ngIf"],["class","list-inline font-size-20 contact-links mb-0",4,"ngIf"],[1,"text-muted"],[1,"list-inline","font-size-20","contact-links","mb-0"],["data-bs-toggle","modal","data-bs-target","#myModal",1,"list-inline-item","px-2",3,"click"],["href","javascript:void(0);","tooltip","Message"],[1,"bx","bx-message-square-dots"],[1,"list-inline-item","px-2"],["tooltip","Profile",3,"routerLink"],[1,"bx","bx-user-circle"],[1,"bx","bx-bar-chart"],[1,"modal-header"],["id","myModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-md-12"],[1,"mb-3"],["for","recipient-name",1,"col-form-label"],["type","text","id","recipient-name","formControlName","title","placeholder","Enter Title",1,"form-control"],["class","text-danger mt-1",4,"ngIf"],["for","message-text",1,"col-form-label"],["id","message-text","formControlName","message","placeholder","Enter Message",1,"form-control"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary","waves-effect",3,"click"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled","click"],[1,"text-danger","mt-1"],[4,"ngIf"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275elementStart(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h4",7),e.\u0275\u0275text(8,"Indirect Reference List"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div",8)(10,"h5",9),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"number"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(13,"div",10)(14,"form",11)(15,"div",2)(16,"div",12),e.\u0275\u0275element(17,"input",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",12),e.\u0275\u0275element(19,"input",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",15),e.\u0275\u0275element(21,"input",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"div",15)(23,"select",17)(24,"option",18),e.\u0275\u0275text(25,"Select Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"option",19),e.\u0275\u0275text(27,"All"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(28,re,2,2,"option",20),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(29,"div",21)(30,"button",22),e.\u0275\u0275listener("click",function(){return n.search()}),e.\u0275\u0275element(31,"i",23),e.\u0275\u0275text(32," Filter"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(33,"div",21)(34,"button",24),e.\u0275\u0275listener("click",function(){return n.reset()}),e.\u0275\u0275element(35,"i",25),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(36,"div",2),e.\u0275\u0275template(37,ie,4,0,"div",26),e.\u0275\u0275template(38,pe,38,9,"div",27),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275template(39,ve,23,4,"ng-template",28,29,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("breadcrumbItems",n.breadCrumbItems),e.\u0275\u0275advance(10),e.\u0275\u0275textInterpolate1("Total Commission: \u20b9",e.\u0275\u0275pipeBind2(12,6,n.totalIndirectCommission,"1.2-2"),""),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",n.searchFormGroup),e.\u0275\u0275advance(14),e.\u0275\u0275property("ngForOf",n.statusList),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngIf",!n.userList||0===n.userList.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.userList&&n.userList.length>0))},dependencies:[c.NgClass,c.NgForOf,c.NgIf,f.V,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,d.N9,l.sg,l.u,u.yS,c.DecimalPipe,c.DatePipe]}),a})();var C=m(1244);const be=["chart"];function Se(a,i){1&a&&(e.\u0275\u0275elementStart(0,"div",5)(1,"div",6)(2,"span",7),e.\u0275\u0275text(3,"Loading..."),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"p",8),e.\u0275\u0275text(5,"Loading income statistics..."),e.\u0275\u0275elementEnd()())}function Ce(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275element(1,"i",10),e.\u0275\u0275text(2),e.\u0275\u0275elementStart(3,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.refreshData())}),e.\u0275\u0275element(4,"i",12),e.\u0275\u0275text(5," Retry "),e.\u0275\u0275elementEnd()()}if(2&a){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.error," ")}}function ye(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"div",50)(1,"div",15)(2,"div",16)(3,"div",51)(4,"div",52)(5,"div"),e.\u0275\u0275element(6,"i"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"div",53)(8,"p",54),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"h4",55),e.\u0275\u0275text(11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"p",56)(13,"span"),e.\u0275\u0275text(14),e.\u0275\u0275elementEnd()()()()()()()),2&a){const t=i.$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275classMapInterpolate1("avatar-title bg-",t.color," rounded-circle font-size-16"),e.\u0275\u0275advance(1),e.\u0275\u0275classMap(t.icon),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.title),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.value),e.\u0275\u0275advance(2),e.\u0275\u0275classMapInterpolate2("badge bg-",t.color,"-subtle text-",t.color,""),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.growth," ")}}const Ie=function(a,i,t){return{"bg-success":a,"bg-danger":i,"bg-secondary":t}};function Ee(a,i){if(1&a&&(e.\u0275\u0275elementStart(0,"tr")(1,"td")(2,"strong"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"td"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"td"),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"td")(9,"span",57),e.\u0275\u0275text(10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"td")(12,"small",34),e.\u0275\u0275text(13),e.\u0275\u0275elementEnd()()()),2&a){const t=i.$implicit,n=i.index,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("\u20b9",((null==r.incomeData.monthlyData||null==r.incomeData.monthlyData.current?null:r.incomeData.monthlyData.current.total[n])||0).toLocaleString(),""),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("\u20b9",((null==r.incomeData.monthlyData||null==r.incomeData.monthlyData.previous?null:r.incomeData.monthlyData.previous.total[n])||0).toLocaleString(),""),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(8,Ie,r.calculateMonthlyGrowth(n)>=0,r.calculateMonthlyGrowth(n)<0,0===r.calculateMonthlyGrowth(n))),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.calculateMonthlyGrowth(n),"% "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate3(" Member: \u20b9",((null==r.incomeData.monthlyData||null==r.incomeData.monthlyData.current?null:r.incomeData.monthlyData.current.member[n])||0).toLocaleString()," | Card: \u20b9",((null==r.incomeData.monthlyData||null==r.incomeData.monthlyData.current?null:r.incomeData.monthlyData.current.card[n])||0).toLocaleString()," | Loan: \u20b9",((null==r.incomeData.monthlyData||null==r.incomeData.monthlyData.current?null:r.incomeData.monthlyData.current.loan[n])||0).toLocaleString()," ")}}const x=function(a,i){return{"text-success":a,"text-danger":i}};function we(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17)(6,"div")(7,"h5",18),e.\u0275\u0275text(8,"Income Statistics Overview"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"p",19),e.\u0275\u0275text(10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"div",20)(12,"button",21),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.refreshData())}),e.\u0275\u0275element(13,"i",22),e.\u0275\u0275text(14," Refresh "),e.\u0275\u0275elementEnd()()()()()()(),e.\u0275\u0275elementStart(15,"div",13),e.\u0275\u0275template(16,ye,15,13,"div",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",13)(18,"div",14)(19,"div",15)(20,"div",24)(21,"h5",25),e.\u0275\u0275text(22,"Income Trend (Current vs Previous Year)"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(23,"div",16)(24,"div",26),e.\u0275\u0275element(25,"apx-chart",27),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(26,"div",13)(27,"div",14)(28,"div",15)(29,"div",24)(30,"h5",25),e.\u0275\u0275text(31,"Income Breakdown by Source"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(32,"div",16)(33,"div",26),e.\u0275\u0275element(34,"apx-chart",28),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(35,"div",13)(36,"div",14)(37,"div",15)(38,"div",24)(39,"h5",25),e.\u0275\u0275text(40,"Monthly Income Details"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(41,"div",16)(42,"div",29)(43,"table",30)(44,"thead",31)(45,"tr")(46,"th"),e.\u0275\u0275text(47,"Month"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(48,"th"),e.\u0275\u0275text(49,"Current Year"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(50,"th"),e.\u0275\u0275text(51,"Previous Year"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"th"),e.\u0275\u0275text(53,"Growth"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(54,"th"),e.\u0275\u0275text(55,"Income Sources (Current Year)"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(56,"tbody"),e.\u0275\u0275template(57,Ee,14,12,"tr",32),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"tfoot",31)(59,"tr")(60,"th"),e.\u0275\u0275text(61,"Total"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(62,"th"),e.\u0275\u0275text(63),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(64,"th"),e.\u0275\u0275text(65),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(66,"th")(67,"span",33),e.\u0275\u0275text(68),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(69,"th")(70,"small",34),e.\u0275\u0275text(71),e.\u0275\u0275elementEnd()()()()()()()()()(),e.\u0275\u0275elementStart(72,"div",35)(73,"div",36)(74,"div",15)(75,"div",24)(76,"h5",25),e.\u0275\u0275text(77,"Income Source Distribution (Current Year)"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(78,"div",16)(79,"div",37)(80,"div",38)(81,"div",39)(82,"div",40),e.\u0275\u0275element(83,"i",41),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(84,"h5",42),e.\u0275\u0275text(85),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(86,"p",19),e.\u0275\u0275text(87,"Member Income"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(88,"p",19),e.\u0275\u0275text(89),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(90,"div",38)(91,"div",39)(92,"div",43),e.\u0275\u0275element(93,"i",44),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(94,"h5",42),e.\u0275\u0275text(95),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(96,"p",19),e.\u0275\u0275text(97,"Card Income"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(98,"p",19),e.\u0275\u0275text(99),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(100,"div",38)(101,"div",39)(102,"div",45),e.\u0275\u0275element(103,"i",46),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(104,"h5",42),e.\u0275\u0275text(105),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(106,"p",19),e.\u0275\u0275text(107,"Loan Income"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(108,"p",19),e.\u0275\u0275text(109),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275elementStart(110,"div",36)(111,"div",15)(112,"div",24)(113,"h5",25),e.\u0275\u0275text(114,"Year-over-Year Growth"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(115,"div",16)(116,"div",35)(117,"div",47)(118,"div",48)(119,"h4",49),e.\u0275\u0275text(120),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(121,"p",19),e.\u0275\u0275text(122,"Member"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(123,"div",47)(124,"div",48)(125,"h4",49),e.\u0275\u0275text(126),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(127,"p",19),e.\u0275\u0275text(128,"Card"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(129,"div",47)(130,"div",48)(131,"h4",49),e.\u0275\u0275text(132),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(133,"p",19),e.\u0275\u0275text(134,"Loan"),e.\u0275\u0275elementEnd()()()()()()()()()}if(2&a){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(10),e.\u0275\u0275textInterpolate2(" Financial Year: ",null==t.incomeData.financialYear||null==t.incomeData.financialYear.current?null:t.incomeData.financialYear.current.start," to ",null==t.incomeData.financialYear||null==t.incomeData.financialYear.current?null:t.incomeData.financialYear.current.end," "),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.summaryCards),e.\u0275\u0275advance(9),e.\u0275\u0275property("series",t.mainChartOptions.series)("chart",t.mainChartOptions.chart)("xaxis",t.mainChartOptions.xaxis)("yaxis",t.mainChartOptions.yaxis)("dataLabels",t.mainChartOptions.dataLabels)("grid",t.mainChartOptions.grid)("stroke",t.mainChartOptions.stroke)("title",t.mainChartOptions.title)("legend",t.mainChartOptions.legend)("colors",t.mainChartOptions.colors)("markers",t.mainChartOptions.markers)("tooltip",t.mainChartOptions.tooltip),e.\u0275\u0275advance(9),e.\u0275\u0275property("series",t.breakdownChartOptions.series)("chart",t.breakdownChartOptions.chart)("plotOptions",t.breakdownChartOptions.plotOptions)("xaxis",t.breakdownChartOptions.xaxis)("yaxis",t.breakdownChartOptions.yaxis)("dataLabels",t.breakdownChartOptions.dataLabels)("colors",t.breakdownChartOptions.colors)("legend",t.breakdownChartOptions.legend)("tooltip",t.breakdownChartOptions.tooltip),e.\u0275\u0275advance(23),e.\u0275\u0275property("ngForOf",null==t.incomeData.metadata?null:t.incomeData.metadata.months),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate1("\u20b9",(null==t.incomeData.totals||null==t.incomeData.totals.current||null==t.incomeData.totals.current.total?null:t.incomeData.totals.current.total.toLocaleString())||"0",""),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("\u20b9",(null==t.incomeData.totals||null==t.incomeData.totals.previous||null==t.incomeData.totals.previous.total?null:t.incomeData.totals.previous.total.toLocaleString())||"0",""),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",(null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.total)||"0","% "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate3(" Member: \u20b9",(null==t.incomeData.totals||null==t.incomeData.totals.current||null==t.incomeData.totals.current.member?null:t.incomeData.totals.current.member.toLocaleString())||"0"," | Card: \u20b9",(null==t.incomeData.totals||null==t.incomeData.totals.current||null==t.incomeData.totals.current.card?null:t.incomeData.totals.current.card.toLocaleString())||"0"," | Loan: \u20b9",(null==t.incomeData.totals||null==t.incomeData.totals.current||null==t.incomeData.totals.current.loan?null:t.incomeData.totals.current.loan.toLocaleString())||"0"," "),e.\u0275\u0275advance(14),e.\u0275\u0275textInterpolate((null==t.incomeData.summary||null==t.incomeData.summary.incomeBreakdown?null:t.incomeData.summary.incomeBreakdown.member)||"0%"),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("\u20b9",(null==t.incomeData.totals||null==t.incomeData.totals.current||null==t.incomeData.totals.current.member?null:t.incomeData.totals.current.member.toLocaleString())||"0",""),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate((null==t.incomeData.summary||null==t.incomeData.summary.incomeBreakdown?null:t.incomeData.summary.incomeBreakdown.card)||"0%"),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("\u20b9",(null==t.incomeData.totals||null==t.incomeData.totals.current||null==t.incomeData.totals.current.card?null:t.incomeData.totals.current.card.toLocaleString())||"0",""),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate((null==t.incomeData.summary||null==t.incomeData.summary.incomeBreakdown?null:t.incomeData.summary.incomeBreakdown.loan)||"0%"),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("\u20b9",(null==t.incomeData.totals||null==t.incomeData.totals.current||null==t.incomeData.totals.current.loan?null:t.incomeData.totals.current.loan.toLocaleString())||"0",""),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(43,x,((null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.member)||0)>=0,((null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.member)||0)<0)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",(null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.member)||"0","% "),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(46,x,((null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.card)||0)>=0,((null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.card)||0)<0)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",(null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.card)||"0","% "),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(49,x,((null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.loan)||0)>=0,((null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.loan)||0)<0)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",(null==t.incomeData.totals||null==t.incomeData.totals.growth?null:t.incomeData.totals.growth.loan)||"0","% ")}}function De(a,i){if(1&a){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",5)(1,"div",58)(2,"div",59),e.\u0275\u0275element(3,"i",60),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"h4",48),e.\u0275\u0275text(5,"No Income Statistics Available"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"p",61),e.\u0275\u0275text(7,"Unable to load income statistics for the selected advisor."),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"button",62),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.refreshData())}),e.\u0275\u0275element(9,"i",22),e.\u0275\u0275text(10," Try Again "),e.\u0275\u0275elementEnd()()}}const ke=[{path:"",component:j},{path:"direct-ref/:id",component:ae},{path:"indirect-ref/:id",component:xe},{path:":advisor_id/income-statics/:type/:user_id",component:(()=>{class a{constructor(t,n){this.route=t,this.userService=n,this.mainChartOptions={},this.breakdownChartOptions={},this.incomeData=null,this.isLoading=!1,this.error="",this.advisorId="",this.userId="",this.type="direct",this.summaryCards=[{title:"Total Earnings",value:"\u20b90",icon:"bx bx-money",color:"primary",growth:"0%"},{title:"Growth",value:"0%",icon:"bx bx-trending-up",color:"success",growth:"0%"},{title:"Top Month",value:"N/A",icon:"bx bx-calendar",color:"info",growth:"0%"},{title:"Active Months",value:"0",icon:"bx bx-time",color:"warning",growth:"0%"}],this.breadCrumbItems=[{label:"Agents",url:"/agents"},{label:"Income Statistics",url:""}]}ngOnInit(){this.initializeChartOptions(),this.advisorId=this.route.snapshot.paramMap.get("advisor_id")||"",this.type=this.route.snapshot.paramMap.get("type")||"direct",this.userId=this.route.snapshot.paramMap.get("user_id")||"",this.advisorId&&this.getUserIncomeStatistics(this.advisorId,this.userId,this.type)}initializeChartOptions(){this.mainChartOptions={series:[],chart:{height:350,type:"line",toolbar:{show:!0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0}}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:3},colors:["#556ee6","#34c38f"],xaxis:{categories:["Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","Jan","Feb","Mar"],title:{text:"Months (Financial Year)"}},yaxis:{title:{text:"Income (\u20b9)"},labels:{formatter:function(t){return"\u20b9"+t.toLocaleString()}}},tooltip:{y:{formatter:function(t){return"\u20b9"+t.toLocaleString()}}},legend:{position:"bottom",horizontalAlign:"center"},grid:{show:!0,borderColor:"#f1f1f1",strokeDashArray:3},markers:{size:4,colors:["#556ee6","#34c38f"],strokeColors:"#fff",strokeWidth:2,hover:{size:6}}},this.breakdownChartOptions={series:[],chart:{height:350,type:"bar",stacked:!0,toolbar:{show:!0}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!1},colors:["#556ee6","#34c38f","#f46a6a"],xaxis:{categories:["Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","Jan","Feb","Mar"]},yaxis:{title:{text:"Income (\u20b9)"},labels:{formatter:function(t){return"\u20b9"+t.toLocaleString()}}},tooltip:{y:{formatter:function(t){return"\u20b9"+t.toLocaleString()}}},legend:{position:"bottom",horizontalAlign:"center"}}}getUserIncomeStatistics(t,n,r){this.isLoading=!0,this.error="",this.userService.getUserIncomeStatistics(t,n,r).subscribe(o=>{o.success&&o.data?(this.incomeData=o.data,this.updateCharts(),this.updateSummaryCards()):this.error="Failed to load income statistics",this.isLoading=!1},o=>{console.error("Error fetching income statistics:",o),this.error=o.error?.message||"Failed to load income statistics",this.isLoading=!1})}updateCharts(){if(this.incomeData&&this.incomeData.series&&(this.mainChartOptions.series=this.incomeData.series,this.incomeData.breakdownSeries)){const t=this.incomeData.breakdownSeries.filter(o=>"member"===o.type&&o.name.includes("Current")),n=this.incomeData.breakdownSeries.filter(o=>"card"===o.type&&o.name.includes("Current")),r=this.incomeData.breakdownSeries.filter(o=>"loan"===o.type&&o.name.includes("Current"));this.breakdownChartOptions.series=[...t.length>0?t:[],...n.length>0?n:[],...r.length>0?r:[]]}}updateSummaryCards(){if(!this.incomeData||!this.incomeData.summary)return;const t=this.incomeData.summary;this.summaryCards=[{title:"Total Earnings",value:`\u20b9${t.totalEarnings?.toLocaleString()||"0"}`,icon:"bx bx-money",color:"primary",growth:t.growthPercentage?`${t.growthPercentage}%`:"0%"},{title:"Year-over-Year Growth",value:t.growthPercentage?`${t.growthPercentage}%`:"0%",icon:"bx bx-trending-up",color:t.growthPercentage>=0?"success":"danger",growth:t.growthPercentage?`${t.growthPercentage}%`:"0%"},{title:"Top Earning Month",value:t.topEarningMonth?.current?.month||"N/A",icon:"bx bx-calendar",color:"info",growth:t.topEarningMonth?.current?.amount?`\u20b9${t.topEarningMonth.current.amount.toLocaleString()}`:"\u20b90"},{title:"Income Breakdown",value:t.incomeBreakdown?.member||"0%",icon:"bx bx-pie-chart-alt",color:"warning",growth:`Member: ${t.incomeBreakdown?.member||"0%"}`}]}onTypeChange(t){this.type=t,this.advisorId&&this.getUserIncomeStatistics(this.advisorId,this.userId,this.type)}refreshData(){this.advisorId&&this.getUserIncomeStatistics(this.advisorId,this.userId,this.type)}exportData(){if(!this.incomeData)return;const t=JSON.stringify(this.incomeData,null,2),n="data:application/json;charset=utf-8,"+encodeURIComponent(t),r=`income-statistics-${this.advisorId}-${this.type}-${(new Date).toISOString().split("T")[0]}.json`,o=document.createElement("a");o.setAttribute("href",n),o.setAttribute("download",r),o.click()}calculateMonthlyGrowth(t){if(!this.incomeData?.monthlyData?.current?.total||!this.incomeData?.monthlyData?.previous?.total)return 0;const n=this.incomeData.monthlyData.current.total[t]||0,r=this.incomeData.monthlyData.previous.total[t]||0;return 0===r?n>0?100:0:Math.round((n-r)/r*100)}}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(u.gz),e.\u0275\u0275directiveInject(p.i))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["app-income-statics"]],viewQuery:function(t,n){if(1&t&&e.\u0275\u0275viewQuery(be,5),2&t){let r;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.chart=r.first)}},decls:6,vars:5,consts:[[1,"container-fluid"],["title","Income Statistics",3,"breadcrumbItems"],["class","text-center py-5",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"mt-2"],["role","alert",1,"alert","alert-danger"],[1,"bx","bx-error-circle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],[1,"bx","bx-refresh"],[1,"row","mb-4"],[1,"col-lg-12"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center"],[1,"card-title","mb-1"],[1,"text-muted","mb-0"],[1,"d-flex","gap-2"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"bx","bx-refresh","me-1"],["class","col-xl-3 col-md-6",4,"ngFor","ngForOf"],[1,"card-header"],[1,"card-title","mb-0"],["dir","ltr",1,"apex-charts"],[3,"series","chart","xaxis","yaxis","dataLabels","grid","stroke","title","legend","colors","markers","tooltip"],[3,"series","chart","plotOptions","xaxis","yaxis","dataLabels","colors","legend","tooltip"],[1,"table-responsive"],[1,"table","table-bordered","table-hover"],[1,"table-light"],[4,"ngFor","ngForOf"],[1,"badge","bg-primary"],[1,"text-muted"],[1,"row"],[1,"col-lg-6"],[1,"d-flex","justify-content-around"],[1,"text-center"],[1,"avatar-lg","mx-auto","mb-3"],[1,"avatar-title","bg-primary","rounded-circle"],[1,"bx","bx-user","font-size-24"],[1,"mb-1"],[1,"avatar-title","bg-success","rounded-circle"],[1,"bx","bx-credit-card","font-size-24"],[1,"avatar-title","bg-warning","rounded-circle"],[1,"bx","bx-money","font-size-24"],[1,"col-4","text-center"],[1,"mb-3"],[1,"mb-1",3,"ngClass"],[1,"col-xl-3","col-md-6"],[1,"d-flex","align-items-center"],[1,"avatar-sm","flex-shrink-0"],[1,"flex-grow-1","ms-3"],[1,"text-muted","mb-1"],[1,"mb-0"],[1,"text-muted","mb-0","mt-1"],[1,"badge",3,"ngClass"],[1,"avatar-lg","mx-auto","mb-4"],[1,"avatar-title","bg-light","rounded-circle"],[1,"bx","bx-bar-chart-alt-2","font-size-48","text-muted"],[1,"text-muted","mb-4"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275template(2,Se,6,0,"div",2),e.\u0275\u0275template(3,Ce,6,1,"div",3),e.\u0275\u0275template(4,we,135,52,"div",4),e.\u0275\u0275template(5,De,11,0,"div",2),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("breadcrumbItems",n.breadCrumbItems),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isLoading),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.error&&!n.isLoading),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.isLoading&&!n.error&&n.incomeData),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.isLoading&&!n.error&&!n.incomeData))},dependencies:[c.NgClass,c.NgForOf,c.NgIf,f.V,C.x]}),a})()}];let Le=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.Bz.forChild(ke),u.Bz]}),a})();var Fe=m(9668),Ae=m(7303);let Te=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=e.\u0275\u0275defineInjector({imports:[c.CommonModule,Fe.v,l.u5,d.jF,l.UX,Le,C.X,d.XC,d.HK,d.Oz,Ae.t]}),a})()}}]);