"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[912],{5912:(ue,F,c)=>{c.r(F),c.d(F,{FranchiseModule:()=>me});var d=c(6895),h=c(9158),o=c(4006),S=c(5226),u=c.n(S),e=c(4650),p=c(2340),I=c(529);let v=(()=>{class r{constructor(t){this.http=t}addFranchise(t){return this.http.post(`${p.N.api_url}franchise`,t)}getFranchises(t=1,n=10,a=""){return this.http.get(`${p.N.api_url}franchise?page=${t}&pageSize=${n}&${a}`)}getFranchiseByUserId(t){return this.http.get(`${p.N.api_url}franchise/${t}`)}getAllAreasWithFranchise(){return this.http.get(`${p.N.api_url}franchise/getAllAreasWithFranchise`)}changeFranchiseStatus(t,n){return this.http.patch(`${p.N.api_url}franchise/changeFranchiseStatus/${t}`,n)}getFranchiseMembers(t,n=1,a=10,i=""){return this.http.get(`${p.N.api_url}franchise/getFranchiseMembers/${t}?page=${n}&pageSize=${a}&${i}`)}getAdvisorStatus(t){return this.http.get(`${p.N.api_url}franchise/getAdvisorStatus/${t}`)}}return r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275inject(I.eN))},r.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var b=c(9234),g=c(9061);function y(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",23),e.\u0275\u0275element(1,"img",24),e.\u0275\u0275elementStart(2,"p",25),e.\u0275\u0275text(3,"No Franchises in current filter."),e.\u0275\u0275elementEnd()())}function E(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",null==t.district[0]?null:t.district[0].name," ")}}function A(r,s){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275element(2,"br"),e.\u0275\u0275elementContainerEnd()),2&r){const t=s.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",t.name," ")}}function w(r,s){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"li",40),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(i.changeStatus(a))}),e.\u0275\u0275elementStart(1,"a",41),e.\u0275\u0275element(2,"i",42),e.\u0275\u0275elementEnd()()}}function M(r,s){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"li",40),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(i.changeStatus(a))}),e.\u0275\u0275elementStart(1,"a",41),e.\u0275\u0275element(2,"i",43),e.\u0275\u0275elementEnd()()}}function P(r,s){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"tr")(2,"td"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"td"),e.\u0275\u0275text(5),e.\u0275\u0275element(6,"br"),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"td"),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"td"),e.\u0275\u0275template(11,E,2,1,"span",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"td"),e.\u0275\u0275template(13,A,3,1,"ng-container",28),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"td")(15,"a",35),e.\u0275\u0275element(16,"i",36),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"td")(18,"span"),e.\u0275\u0275text(19),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(20,"td"),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"date"),e.\u0275\u0275element(23,"br"),e.\u0275\u0275elementStart(24,"span",37),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"date"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(27,"td")(28,"ul",38),e.\u0275\u0275template(29,w,3,0,"li",39),e.\u0275\u0275template(30,M,3,0,"li",39),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()),2&r){const t=s.$implicit,n=s.index,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate((a.page-1)*a.pageSize+n+1),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",null==t.user?null:t.user.name," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" (",null==t.user?null:t.user.user_id,")"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",null==t.state?null:t.state.name," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",0!==t.district.length),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.area),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate1("routerLink","/franchises/member-list/",t._id,""),e.\u0275\u0275advance(3),e.\u0275\u0275classMapInterpolate1("badge bg-",t.status?"success":"danger",""),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.status?"Active":"InActive"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(22,15,t.createdAt)," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("Modified At : ",e.\u0275\u0275pipeBind1(26,17,t.updatedAt),""),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",t.status),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.status)}}function L(r,s){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",26)(1,"table",27)(2,"thead")(3,"tr")(4,"th"),e.\u0275\u0275text(5,"S.No."),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"th"),e.\u0275\u0275text(7,"User"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"th"),e.\u0275\u0275text(9,"State"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"th"),e.\u0275\u0275text(11,"District"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"th"),e.\u0275\u0275text(13,"Area"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"th"),e.\u0275\u0275text(15,"User List"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"th"),e.\u0275\u0275text(17,"Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"th"),e.\u0275\u0275text(19,"CreatedAt"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"th"),e.\u0275\u0275text(21,"Actions"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(22,"tbody"),e.\u0275\u0275template(23,P,31,19,"ng-container",28),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(24,"div",29)(25,"div",30)(26,"div",31),e.\u0275\u0275text(27,"Showing "),e.\u0275\u0275elementStart(28,"b"),e.\u0275\u0275text(29),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(30),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(31,"div",30)(32,"div",32)(33,"ngb-pagination",33),e.\u0275\u0275listener("pageChange",function(a){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.page=a)})("pageChange",function(a){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.pageChange(a))}),e.\u0275\u0275elementEnd()()()()()}if(2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(23),e.\u0275\u0275property("ngForOf",t.franchiseList),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate((t.page-1)*t.pageSize+1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" to ",t.findPageShowing()," of ",t.total," entries "),e.\u0275\u0275advance(3),e.\u0275\u0275property("collectionSize",t.total)("page",t.page)("pageSize",t.pageSize)}}let T=(()=>{class r{constructor(t){this.franchiseService=t,this.franchiseList=[],this.total=0,this.page=1,this.pageSize=10,this.queryParams=""}ngOnInit(){this.breadCrumbItems=[{label:"Franchise"},{label:"List",active:!0}],this.searchFormGroup=new o.cw({search:new o.NI(""),status:new o.NI("")}),this.getFranchises()}search(){this.page=1;const t=this.searchFormGroup.value,n=[];Object.keys(t).forEach(a=>{null!==t[a]&&""!==t[a]&&n.push(`${a}=${encodeURIComponent(t[a])}`)}),this.queryParams=n.join("&"),this.getFranchises()}getFranchises(){this.franchiseService.getFranchises(this.page,this.pageSize,this.queryParams).subscribe({next:t=>{t&&t.data&&(this.franchiseList=t.data.franchises||[],this.total=t.data.total||0)},error:t=>{console.error("Error fetching franchise list:",t)}})}resetSearch(){this.searchFormGroup.reset(),this.page=1,this.queryParams="",this.getFranchises()}findPageShowing(){return Math.min(this.page*this.pageSize,this.total)}pageChange(t){this.page=t,this.getFranchises()}changeStatus(t){console.log("Changing status for:",t),u().fire({title:"Change Status",text:`Are you sure you want to change the status of ${t?.user?.name}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, change it!",cancelButtonText:"No, cancel!"}).then(n=>{if(n.isConfirmed){const a={status:"Active"===t.status?"Inactive":"Active"};this.franchiseService.changeFranchiseStatus(t._id,{status:!t.status}).subscribe({next:i=>{i&&"success"===i.status?(u().fire("Success",`Franchise status has been changed to ${a.status}.`,"success"),this.getFranchises()):u().fire("Error","Failed to change the franchise status. Please try again.","error")},error:i=>{console.error("Error changing franchise status:",i),u().fire("Error","Failed to change the franchise status. Please try again.","error")}})}})}}return r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(v))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-franchise-list"]],decls:29,vars:6,consts:[[1,"container-fluid"],["title","Franchise List",3,"breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card"],[1,"card-body","border-bottom"],[3,"formGroup"],[1,"row","g-3"],[1,"col-lg-6"],["type","search","id","searchInput","placeholder","Search for User Id/Name...","formControlName","search",1,"form-control"],[1,"col-lg-3"],["formControlName","status",1,"form-control","select2"],["value",""],[3,"value"],[1,"col-lg-2"],["type","button",1,"btn","btn-soft-secondary","w-100",3,"click"],[1,"mdi","mdi-filter-outline","align-middle"],[1,"col-lg-1"],["href","javascript:void(0);",1,"btn","btn-light",3,"click"],[1,"mdi","mdi-refresh"],[1,"card-body"],["class","d-flex flex-column justify-content-center align-items-center","style","min-height: 150px;",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"d-flex","flex-column","justify-content-center","align-items-center",2,"min-height","150px"],["src","assets/img/not-found.png","width","300px","alt",""],[1,"text-mutes","mt-2"],[1,"table-responsive"],["id","basic-datatable",1,"table","table-bordered","dt-responsive","nowrap","datatables","no-footer","dtr-inline"],[4,"ngFor","ngForOf"],[1,"row","justify-content-md-between","align-items-md-center","mt-2"],[1,"col-sm-12","col-md-5"],["id","tickets-table_info","role","status","aria-live","polite",1,"dataTables_info","mb-2"],[1,"text-md-right","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","pageChange"],[4,"ngIf"],["data-bs-toggle","modal",1,"btn","btn-sm","btn-soft-primary",3,"routerLink"],[1,"mdi","mdi-account-multiple"],[1,"text-muted"],[1,"list-inline","font-size-20","contact-links","mb-0"],["class","list-inline-item px-2",3,"click",4,"ngIf"],[1,"list-inline-item","px-2",3,"click"],["href","javascript:void(0);","tooltip","Message"],[1,"bx","bx-lock"],[1,"bx","bx-lock-open"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275elementStart(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"form",6)(7,"div",7)(8,"div",8),e.\u0275\u0275element(9,"input",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",10)(11,"select",11)(12,"option",12),e.\u0275\u0275text(13,"Select Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"option",13),e.\u0275\u0275text(15,"Active"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"option",13),e.\u0275\u0275text(17,"Inactive"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(18,"div",14)(19,"button",15),e.\u0275\u0275listener("click",function(){return n.search()}),e.\u0275\u0275element(20,"i",16),e.\u0275\u0275text(21," Filter"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",17)(23,"a",18),e.\u0275\u0275listener("click",function(){return n.resetSearch()}),e.\u0275\u0275element(24,"i",19),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(25,"div",20)(26,"div",2),e.\u0275\u0275template(27,y,4,0,"div",21),e.\u0275\u0275template(28,L,34,7,"div",22),e.\u0275\u0275elementEnd()()()()()()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("breadcrumbItems",n.breadCrumbItems),e.\u0275\u0275advance(5),e.\u0275\u0275property("formGroup",n.searchFormGroup),e.\u0275\u0275advance(8),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(11),e.\u0275\u0275property("ngIf",!n.franchiseList||0===n.franchiseList.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.franchiseList&&n.franchiseList.length>0))},dependencies:[d.NgForOf,d.NgIf,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.sg,o.u,b.V,g.N9,h.yS,d.DatePipe]}),r})();var k=c(5933),N=c(8386),O=c(7185),G=c(3321),C=c(150);function D(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"div",26)(1,"small")(2,"strong"),e.\u0275\u0275text(3,"Name:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"br"),e.\u0275\u0275elementEnd()),2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",t.userDetails.name,"")}}function $(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",27),e.\u0275\u0275text(1," User ID is required. "),e.\u0275\u0275elementEnd())}function j(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",28),e.\u0275\u0275text(1," User not found. Please enter a valid User ID. "),e.\u0275\u0275elementEnd())}function z(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",28),e.\u0275\u0275text(1," User is not an advisor or doesnt have 3 active users. Please select an advisor. "),e.\u0275\u0275elementEnd())}function V(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",27),e.\u0275\u0275text(1," Name is required. "),e.\u0275\u0275elementEnd())}function q(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",27),e.\u0275\u0275text(1," District is required. "),e.\u0275\u0275elementEnd())}function U(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",27),e.\u0275\u0275text(1," Areas is required. "),e.\u0275\u0275elementEnd())}function B(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"div",27),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.areaAlreadyExistsmessage," ")}}function R(r,s){1&r&&(e.\u0275\u0275elementStart(0,"span",27),e.\u0275\u0275text(1,"*"),e.\u0275\u0275elementEnd())}function J(r,s){1&r&&(e.\u0275\u0275elementStart(0,"span",29),e.\u0275\u0275text(1,"(Uploaded)"),e.\u0275\u0275elementEnd())}function W(r,s){1&r&&(e.\u0275\u0275elementStart(0,"small",30),e.\u0275\u0275text(1,"Click on the image below to change"),e.\u0275\u0275elementEnd())}function Y(r,s){if(1&r&&e.\u0275\u0275element(0,"img",34),2&r){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("src",t.uploadedChequeProof,e.\u0275\u0275sanitizeUrl)}}function K(r,s){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",18)(1,"label",31),e.\u0275\u0275text(2,"Cheque Proof Preview"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",32),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext();const a=e.\u0275\u0275reference(39);return e.\u0275\u0275resetView(a.click())}),e.\u0275\u0275template(4,Y,1,1,"img",33),e.\u0275\u0275elementEnd()()}if(2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",t.uploadedChequeProof)}}function H(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"option",25),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=s.$implicit;e.\u0275\u0275property("ngValue",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function Q(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"div",26)(1,"div",27)(2,"strong",28),e.\u0275\u0275text(3,"Total Franchise Commission:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"number"),e.\u0275\u0275elementEnd()()()),2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("\u20b9 ",e.\u0275\u0275pipeBind2(6,1,t.totalDirectCommission,"1.2-2"),"")}}function Z(r,s){1&r&&(e.\u0275\u0275elementStart(0,"div",29),e.\u0275\u0275element(1,"img",30),e.\u0275\u0275elementStart(2,"p",31),e.\u0275\u0275text(3,"No Users Found in current filter."),e.\u0275\u0275elementEnd()())}function ee(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"span",45),e.\u0275\u0275text(1),e.\u0275\u0275element(2,"br"),e.\u0275\u0275elementEnd()),2&r){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" Gardian : ",t.guardian_name||"-"," (",t.guardian_relation,") ")}}const x=function(r,s,t){return{"badge-soft-primary":r,"badge-soft-warning":s,"badge-soft-danger":t}};function te(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"a",42),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,x,"Approved"===(null==t||null==t.kyc[0]?null:t.kyc[0].status),"Requested"===(null==t||null==t.kyc[0]?null:t.kyc[0].status),"Rejected"===(null==t||null==t.kyc[0]?null:t.kyc[0].status))),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" KYC ",null==t||null==t.kyc[0]?null:t.kyc[0].status," ")}}function ne(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"a",42),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,x,"Approved"===t.franchise_status,"Requested"===t.franchise_status,"Rejected"===t.franchise_status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Franchise ",t.franchise_status," ")}}function re(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"a",42),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(2,x,"Approved"===t.advisor_status,"Requested"===t.advisor_status,"Rejected"===t.advisor_status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Advisor ",t.advisor_status," ")}}function ae(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"ul",46)(1,"li",47)(2,"a",48),e.\u0275\u0275element(3,"i",49),e.\u0275\u0275elementEnd()()()),2&r){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate1("routerLink","/members/view/",t._id,"")}}const ie=function(r,s,t,n){return{"badge-soft-primary":r,"badge-soft-warning":s,"badge-soft-danger":t,"badge-soft-secondary":n}};function se(r,s){if(1&r&&(e.\u0275\u0275elementStart(0,"tr")(1,"td"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"td"),e.\u0275\u0275text(4),e.\u0275\u0275element(5,"br"),e.\u0275\u0275template(6,ee,3,2,"span",41),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"td"),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"td"),e.\u0275\u0275text(10),e.\u0275\u0275element(11,"br"),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"td")(14,"b"),e.\u0275\u0275text(15," Member: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"number"),e.\u0275\u0275element(18,"br"),e.\u0275\u0275elementStart(19,"b"),e.\u0275\u0275text(20," Card: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"number"),e.\u0275\u0275element(23,"br"),e.\u0275\u0275elementStart(24,"b"),e.\u0275\u0275text(25," Loan: "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(26),e.\u0275\u0275pipe(27,"number"),e.\u0275\u0275element(28,"br"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"td"),e.\u0275\u0275text(30),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"td"),e.\u0275\u0275text(32),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"td"),e.\u0275\u0275text(34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"td"),e.\u0275\u0275text(36),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"td"),e.\u0275\u0275text(38),e.\u0275\u0275pipe(39,"date"),e.\u0275\u0275element(40,"br"),e.\u0275\u0275text(41),e.\u0275\u0275pipe(42,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(43,"td")(44,"a",42),e.\u0275\u0275text(45),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(46,te,2,6,"a",43),e.\u0275\u0275template(47,ne,2,6,"a",43),e.\u0275\u0275template(48,re,2,6,"a",43),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(49,"td"),e.\u0275\u0275template(50,ae,4,1,"ul",44),e.\u0275\u0275elementEnd()()),2&r){const t=s.$implicit,n=s.index,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate((a.page-1)*a.pageSize+n+1),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.name," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.guardian_name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.user_id),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",null==t.referred_by[0]?null:t.referred_by[0].name," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",(null==t.referred_by[0]?null:t.referred_by[0].user_id)||"-"," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" \u20b9 ",e.\u0275\u0275pipeBind2(17,21,t.franchiseCommission,"1.2-2")," "),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" \u20b9 ",e.\u0275\u0275pipeBind2(22,24,t.creditCardFranchiseCommission,"1.2-2")," "),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" \u20b9 ",e.\u0275\u0275pipeBind2(27,27,t.loan_franchise,"1.2-2")," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate((null==t||null==t.area_info[0]?null:t.area_info[0].name)||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.account_number||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.gender||"-"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.date_of_birth?a.getAge(t.date_of_birth):"-"," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" Joining : ",e.\u0275\u0275pipeBind1(39,30,t.created_date)," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" Approved : ",e.\u0275\u0275pipeBind1(42,32,t.approved_date)," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction4(34,ie,"Active"===t.status,"Pending"===t.status,"Blocked"===t.status||"Deleted"===t.status,"Inactive"===t.status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" Account ",t.status," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1==t.kyc.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.franchise_status),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.advisor_status),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","Deleted"!==t.status)}}function oe(r,s){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",32)(1,"table",33)(2,"thead")(3,"tr")(4,"th"),e.\u0275\u0275text(5,"Sr No"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"th"),e.\u0275\u0275text(7,"Name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"th"),e.\u0275\u0275text(9,"UserId"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"th"),e.\u0275\u0275text(11,"Refer Id"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"th"),e.\u0275\u0275text(13,"Commission"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"th"),e.\u0275\u0275text(15,"Area"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"th"),e.\u0275\u0275text(17,"Account Number"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"th"),e.\u0275\u0275text(19,"Gender"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"th"),e.\u0275\u0275text(21,"Age"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"th"),e.\u0275\u0275text(23,"Date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"th",34),e.\u0275\u0275text(25,"Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"th",34),e.\u0275\u0275text(27,"Action"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(28,"tbody"),e.\u0275\u0275template(29,se,51,39,"tr",35),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(30,"div",36)(31,"div",37)(32,"div",38),e.\u0275\u0275text(33,"Showing "),e.\u0275\u0275elementStart(34,"b"),e.\u0275\u0275text(35),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(36),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(37,"div",37)(38,"div",39)(39,"ngb-pagination",40),e.\u0275\u0275listener("pageChange",function(a){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.page=a)})("pageChange",function(a){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.pageChange(a))}),e.\u0275\u0275elementEnd()()()()()}if(2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(24),e.\u0275\u0275property("width",10),e.\u0275\u0275advance(2),e.\u0275\u0275property("width",10),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.userList),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate((t.page-1)*t.pageSize+1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" to ",t.findPageShowing()," of ",t.total," entries "),e.\u0275\u0275advance(3),e.\u0275\u0275property("collectionSize",t.total)("page",t.page)("pageSize",t.pageSize)}}const le=[{path:"list",component:T},{path:"add",component:(()=>{class r{constructor(t,n,a,i,l,m){this.userService=t,this.toast=n,this.router=a,this.modalService=i,this.masterService=l,this.franchiseService=m,this.userDetails=null,this.allDistricts=[],this.allAreas=[],this.allStates=[],this.allAreasWithFranchiseUser=[],this.areaAlreadyExistsmessage="",this.isEditMode=!1,this.currentFranchiseId=null,this.uploadedChequeProof=""}ngOnInit(){this.breadCrumbItems=[{label:"Franchise"},{label:"Manage",active:!0}],this.getStates(),this.getAllAreasWithFranchise(),this.addFranchiseFormGroup=new o.cw({user_id:new o.NI("",o.kI.required),state:new o.NI({value:"",disabled:!0},o.kI.required),district:new o.NI({value:"",disabled:!0},o.kI.required),area:new o.NI([],o.kI.required),cheque_proof:new o.NI(null,o.kI.required)})}getUserDetails(){!this.addFranchiseFormGroup.value.user_id||this.franchiseService.getAdvisorStatus(this.addFranchiseFormGroup.value.user_id).subscribe({next:t=>{t&&"success"===t.status&&(t.data.isAdvisor?(this.addFranchiseFormGroup.get("user_id")?.setErrors(null),this.addFranchiseFormGroup.get("user_id")?.markAsPristine(),this.addFranchiseFormGroup.get("user_id")?.markAsUntouched(),this.userDetails=t.data.user,this.getFranchiseByUserId(this.userDetails._id),this.getDistricts({_id:this.userDetails.state}),this.getAreas({_id:this.userDetails.district}),this.addFranchiseFormGroup.patchValue({state:this.userDetails.state,district:this.userDetails.district}),this.addFranchiseFormGroup.get("state")?.disable()):t.data.user?(this.userDetails=t.data.user,this.addFranchiseFormGroup.get("user_id")?.setErrors({notAdvisor:!0})):(this.userDetails=null,this.addFranchiseFormGroup.get("user_id")?.setErrors({userNotFound:!0})))},error:t=>{console.error("Error checking advisor status:",t),this.toast.error("An error occurred while checking advisor status")}})}getFranchiseByUserId(t){this.franchiseService.getFranchiseByUserId(t).subscribe({next:n=>{if(n&&n.data){const a=n.data.franchise;a&&(this.isEditMode=!0,this.currentFranchiseId=a._id,this.addFranchiseFormGroup.patchValue({area:a?.area.map(i=>i._id)||[],cheque_proof:a?.cheque_proof||null}),this.uploadedChequeProof=a?.cheque_proof||null,this.uploadedChequeProof&&(this.addFranchiseFormGroup.get("cheque_proof")?.clearValidators(),this.addFranchiseFormGroup.get("cheque_proof")?.updateValueAndValidity())),console.log("Franchise Details:",a)}},error:n=>{console.error("Error fetching franchise by user ID:",n),this.toast.error("An error occurred while fetching franchise details")}})}getStates(){this.masterService.states().subscribe({next:t=>{t&&t.data&&(this.allStates=t.data||[])},error:t=>{console.error("Error loading states:",t)}})}getDistricts(t){t&&t?._id?this.masterService.districts(t._id).subscribe({next:n=>{n&&n.data&&(this.allDistricts=n.data||[])},error:n=>{console.error("Error loading districts:",n)}}):this.allDistricts=[]}getAreas(t){t&&t?._id?this.masterService.areas(t._id).subscribe({next:n=>{n&&n.data&&(this.allAreas=n.data||[])},error:n=>{console.error("Error loading areas:",n)}}):this.allAreas=[]}onSubmit(){if(this.addFranchiseFormGroup.invalid)return this.addFranchiseFormGroup.markAllAsTouched(),void this.toast.error("Please fix the errors in the form.");const t={user_id:this.userDetails._id,state:this.userDetails?.state||this.addFranchiseFormGroup.value.state,district:this.userDetails?.district||this.addFranchiseFormGroup.value.district,area:this.addFranchiseFormGroup.value.area,cheque_proof:this.uploadedChequeProof};console.log("Form Data:",t),this.franchiseService.addFranchise(t).subscribe({next:n=>{n.status?(u().fire({title:"Success",text:"Franchise added successfully",icon:"success",confirmButtonText:"OK"}).then(()=>{this.router.navigate(["/franchises/list"])}),this.toast.success("Franchise added successfully"),this.addFranchiseFormGroup.reset(),this.userDetails=null,this.allDistricts=[],this.allAreas=[]):this.toast.error(n.message||"Failed to add franchise")},error:n=>{console.error("Error adding franchise:",n),this.toast.error("An error occurred while adding the franchise"),u().fire({title:"Error",text:"An error occurred while adding the franchise",icon:"error",confirmButtonText:"OK"})}})}areaSelected(t){const n=t[t.length-1];if(n&&n._id){const a=this.allAreasWithFranchiseUser.find(i=>i._id===n._id);if(a){if(this.isEditMode&&a?.user?.[0]?._id===this.userDetails?._id)return;this.toast.error(`This area is already associated with a franchise ${a?.user[0]?.name} (${a?.user[0]?.user_id})`),this.addFranchiseFormGroup.get("area")?.setErrors({areaAlreadyExists:!0}),setTimeout(()=>{this.addFranchiseFormGroup.get("area")?.setErrors(null),this.areaAlreadyExistsmessage=""},5e3),this.areaAlreadyExistsmessage=`${a.name} area is already associated with a franchise ${a?.user[0]?.name} (${a?.user[0]?.user_id})`,this.addFranchiseFormGroup.markAllAsTouched(),this.addFranchiseFormGroup.patchValue({area:t.filter(i=>i._id!==n._id).map(i=>i._id)})}}}getAllAreasWithFranchise(){this.franchiseService.getAllAreasWithFranchise().subscribe({next:t=>{this.allAreasWithFranchiseUser=t?.data?.areas||[],console.log("Areas with franchise:",this.allAreasWithFranchiseUser)},error:t=>{console.error("Error loading areas with franchise:",t),this.toast.error("An error occurred while loading areas with franchise")}})}onFileSelected(t,n){const a=t.target;if(a.files&&0!==a.files.length)return a.files[0].type.startsWith("image/")?void(a.files&&a.files.length>0&&this.openImageCropper({file:t,from:n})):(u().fire({title:"Invalid File Type",text:"Please select a valid image file.",icon:"error",confirmButtonText:"OK"}),void(a.value=""))}openImageCropper(t){const n=this.modalService.open(k.a,{centered:!0,size:"xl"});n.componentInstance.data=t,n.result.then(a=>{a&&a.image&&this.cropAndSetPhoto(a.image,a.from)}).catch(a=>{console.log("Modal dismissed:",a)})}cropAndSetPhoto(t,n="chequeProof"){const a=new Image;a.onload=()=>{const i=document.createElement("canvas");i.width=.5*a.width,i.height=.5*a.height,i.getContext("2d").drawImage(a,0,0,i.width,i.height);const m=i.toDataURL("image/jpeg",.3);"chequeProof"===n&&(this.uploadedChequeProof=m,this.addFranchiseFormGroup.patchValue({cheque_proof:m})),console.log(`Selected ${n}:`)},a.src=t}}return r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(N.i),e.\u0275\u0275directiveInject(O._W),e.\u0275\u0275directiveInject(h.F0),e.\u0275\u0275directiveInject(g.FF),e.\u0275\u0275directiveInject(G.R),e.\u0275\u0275directiveInject(v))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-franchise-add"]],decls:44,vars:19,consts:[[1,"container-fluid"],["title","Manage Franchise",3,"breadcrumbItems"],[1,"row"],[1,"col-lg-12"],[1,"card"],[1,"card-body"],[1,"col-12",3,"formGroup"],[1,"mb-3","col-lg-12"],["for","messageTitle",1,"form-label"],["type","text","id","messageTitle","formControlName","user_id","placeholder","Enter title",1,"form-control",3,"blur"],["class","mt-1",4,"ngIf"],["class","text-danger",4,"ngIf"],["class","text-danger mt-1",4,"ngIf"],[1,"mb-3","col-lg-6"],["for","messageBody",1,"form-label"],["formControlName","state","placeholder","Search for a state...","bindLabel","name","bindValue","_id",3,"items","change"],["formControlName","district","placeholder","Search for a district...","bindLabel","name","bindValue","_id",3,"items","change"],["formControlName","area","placeholder","Search for areas...","bindLabel","name","bindValue","_id",1,"custom-ng-select",3,"items","multiple","change"],[1,"col-md-6","mb-3"],["for","chequeProof",1,"form-label"],["class","text-success",4,"ngIf"],["type","file","id","chequeProof","accept","image/*",1,"form-control",3,"change"],["selfPassbookInput",""],["class","text-muted",4,"ngIf"],["class","col-md-6 mb-3",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[1,"mt-1"],[1,"text-danger"],[1,"text-danger","mt-1"],[1,"text-success"],[1,"text-muted"],[1,"form-label"],[1,"passbook_box",2,"cursor","pointer","border","2px solid #ddd","padding","10px","border-radius","5px",3,"click"],["alt","Cheque Proof","style","max-width: 100%; height: auto; display: block;",3,"src",4,"ngIf"],["alt","Cheque Proof",2,"max-width","100%","height","auto","display","block",3,"src"]],template:function(t,n){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275elementStart(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",2)(7,"form",6)(8,"div",7)(9,"label",8),e.\u0275\u0275text(10,"User ID"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"input",9),e.\u0275\u0275listener("blur",function(){return n.getUserDetails()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,D,6,1,"div",10),e.\u0275\u0275template(13,$,2,0,"div",11),e.\u0275\u0275template(14,j,2,0,"div",12),e.\u0275\u0275template(15,z,2,0,"div",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",2)(17,"div",13)(18,"label",14),e.\u0275\u0275text(19,"State"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"ng-select",15),e.\u0275\u0275listener("change",function(i){return n.getDistricts(i)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,V,2,0,"div",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"div",13)(23,"label",14),e.\u0275\u0275text(24,"District"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"ng-select",16),e.\u0275\u0275listener("change",function(i){return n.getAreas(i)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(26,q,2,0,"div",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(27,"div",7)(28,"label",14),e.\u0275\u0275text(29,"Area"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"ng-select",17),e.\u0275\u0275listener("change",function(i){return n.areaSelected(i)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(31,U,2,0,"div",11),e.\u0275\u0275template(32,B,2,1,"div",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"div",18)(34,"label",19),e.\u0275\u0275text(35," Cheque Proof "),e.\u0275\u0275template(36,R,2,0,"span",11),e.\u0275\u0275template(37,J,2,0,"span",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"input",21,22),e.\u0275\u0275listener("change",function(i){return n.onFileSelected(i,"chequeProof")}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(40,W,2,0,"small",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(41,K,5,1,"div",24),e.\u0275\u0275elementStart(42,"button",25),e.\u0275\u0275listener("click",function(){return n.onSubmit()}),e.\u0275\u0275text(43,"Submit"),e.\u0275\u0275elementEnd()()()()()()()()),2&t){let a,i,l,m,f,_;e.\u0275\u0275advance(1),e.\u0275\u0275property("breadcrumbItems",n.breadCrumbItems),e.\u0275\u0275advance(6),e.\u0275\u0275property("formGroup",n.addFranchiseFormGroup),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",n.userDetails),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==(a=n.addFranchiseFormGroup.get("user_id"))?null:a.touched)&&(null==(a=n.addFranchiseFormGroup.get("user_id"))||null==a.errors?null:a.errors.required)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==(i=n.addFranchiseFormGroup.get("user_id"))?null:i.touched)&&(null==(i=n.addFranchiseFormGroup.get("user_id"))||null==i.errors?null:i.errors.userNotFound)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==(l=n.addFranchiseFormGroup.get("user_id"))?null:l.touched)&&(null==(l=n.addFranchiseFormGroup.get("user_id"))||null==l.errors?null:l.errors.notAdvisor)),e.\u0275\u0275advance(5),e.\u0275\u0275property("items",n.allStates),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==(m=n.addFranchiseFormGroup.get("name"))?null:m.touched)&&(null==(m=n.addFranchiseFormGroup.get("name"))?null:m.invalid)),e.\u0275\u0275advance(4),e.\u0275\u0275property("items",n.allDistricts),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==(f=n.addFranchiseFormGroup.get("district"))?null:f.touched)&&(null==(f=n.addFranchiseFormGroup.get("district"))?null:f.invalid)),e.\u0275\u0275advance(4),e.\u0275\u0275property("items",n.allAreas)("multiple",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==(_=n.addFranchiseFormGroup.get("area"))?null:_.touched)&&(null==(_=n.addFranchiseFormGroup.get("area"))?null:_.invalid)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.areaAlreadyExistsmessage),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",!n.uploadedChequeProof),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.uploadedChequeProof),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.uploadedChequeProof),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.uploadedChequeProof),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",n.addFranchiseFormGroup.invalid)}},dependencies:[d.NgIf,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,b.V,C.w9]}),r})()},{path:"member-list/:id",component:(()=>{class r{constructor(t,n){this.franchiseService=t,this.route=n,this.page=1,this.pageSize=10,this.total=0,this.queryParams="",this.userId="",this.totalDirectCommission=0,this.userList=[],this.statusList=["Pending","Active","Inactive","Blocked"],this.userId=this.route.snapshot.paramMap.get("id")||""}ngOnInit(){this.breadCrumbItems=[{label:"Franchise"},{label:"List Members",active:!0}],this.searchFormGroup=new o.cw({name:new o.NI(""),user_id:new o.NI(""),account_number:new o.NI(""),status:new o.NI("")}),this.getFranchiseMembers(this.userId)}reset(){this.page=1,this.searchFormGroup.reset(),this.getFranchiseMembers()}getAge(t){const n=new Date,a=new Date(t);let i=n.getFullYear()-a.getFullYear();const l=n.getMonth()-a.getMonth();return(l<0||0===l&&n.getDate()<a.getDate())&&i--,i}findPageShowing(){return Math.min(this.page*this.pageSize,this.total)}pageChange(t){this.page=t,this.getFranchiseMembers(this.userId)}getFranchiseMembers(t=this.userId){const n=this.searchFormGroup.value,a=[];Object.keys(n).forEach(l=>{null!==n[l]&&""!==n[l]&&a.push(`${l}=${encodeURIComponent(n[l])}`)});const i=a.join("&");this.franchiseService.getFranchiseMembers(t,this.page,this.pageSize,i).subscribe({next:l=>{l&&l.data&&(this.userList=l.data?.users?.data||[],console.log(this.userList),this.total=l.data.users?.metadata[0]?.count||0,this.totalDirectCommission=(l.data.users?.metadata[0]?.totalFranchiseCommission||0)+(l.data.users?.metadata[0]?.totalCreditCardFranchiseCommission||0)+(l.data.users?.metadata[0]?.totalLoanFranchise||0))},error:l=>{console.error("Error fetching franchise members:",l)}})}}return r.\u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(h.gz))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-list-members"]],decls:33,vars:6,consts:[[1,"container-fluid"],["title","Franchise Members",3,"breadcrumbItems"],[1,"row"],[1,"col-xl-12"],[1,"card"],[1,"card-body"],[1,"card-body","border-bottom"],[3,"formGroup"],[1,"col-lg-3"],["type","search","id","searchInput","formControlName","name","placeholder","Search for Name...",1,"form-control"],["type","search","id","searchInput","formControlName","account_number","placeholder","Search for Account Number...",1,"form-control"],[1,"col-lg-2"],["type","search","id","searchInput","formControlName","user_id","placeholder","Search for User id...",1,"form-control"],["formControlName","status",1,"form-control","select2"],["value",""],["value","All"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-lg-1"],["type","button",1,"btn","btn-soft-secondary","w-100",3,"click"],[1,"mdi","mdi-filter-outline","align-middle"],["type","button",1,"btn","btn-light",3,"click"],[1,"mdi","mdi-refresh"],["class","commission-legend d-flex justify-content-between align-items-center",4,"ngIf"],["class","d-flex flex-column justify-content-center align-items-center","style","min-height: 150px;",4,"ngIf"],["class","table-responsive",4,"ngIf"],[3,"ngValue"],[1,"commission-legend","d-flex","justify-content-between","align-items-center"],[1,"mb-2","ms-auto","d-flex","align-items-center"],[1,"me-2"],[1,"d-flex","flex-column","justify-content-center","align-items-center",2,"min-height","150px"],["src","assets/img/not-found.png","width","300px","alt",""],[1,"text-mutes","mt-2"],[1,"table-responsive"],["id","basic-datatable",1,"table","table-bordered","dt-responsive","nowrap","datatables","no-footer","dtr-inline"],[3,"width"],[4,"ngFor","ngForOf"],[1,"row","justify-content-md-between","align-items-md-center","mt-2"],[1,"col-sm-12","col-md-5"],["id","tickets-table_info","role","status","aria-live","polite",1,"dataTables_info","mb-2"],[1,"text-md-right","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","pageChange"],["class","text-muted",4,"ngIf"],["href","javascript: void(0);",1,"badge","font-size-11","m-1",3,"ngClass"],["href","javascript: void(0);","class","badge font-size-11 m-1",3,"ngClass",4,"ngIf"],["class","list-inline font-size-20 contact-links mb-0",4,"ngIf"],[1,"text-muted"],[1,"list-inline","font-size-20","contact-links","mb-0"],[1,"list-inline-item","px-2"],["tooltip","Profile",3,"routerLink"],[1,"bx","bx-user-circle"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275elementStart(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"form",7)(8,"div",2)(9,"div",8),e.\u0275\u0275element(10,"input",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",8),e.\u0275\u0275element(12,"input",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",11),e.\u0275\u0275element(14,"input",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"div",11)(16,"select",13)(17,"option",14),e.\u0275\u0275text(18,"Select Status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"option",15),e.\u0275\u0275text(20,"All"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,H,2,2,"option",16),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",17)(23,"button",18),e.\u0275\u0275listener("click",function(){return n.getFranchiseMembers()}),e.\u0275\u0275element(24,"i",19),e.\u0275\u0275text(25," Filter"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(26,"div",17)(27,"button",20),e.\u0275\u0275listener("click",function(){return n.reset()}),e.\u0275\u0275element(28,"i",21),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275template(29,Q,7,4,"div",22),e.\u0275\u0275elementStart(30,"div",2),e.\u0275\u0275template(31,Z,4,0,"div",23),e.\u0275\u0275template(32,oe,40,9,"div",24),e.\u0275\u0275elementEnd()()()()()()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("breadcrumbItems",n.breadCrumbItems),e.\u0275\u0275advance(6),e.\u0275\u0275property("formGroup",n.searchFormGroup),e.\u0275\u0275advance(14),e.\u0275\u0275property("ngForOf",n.statusList),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",n.userList&&n.userList.length>0),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!n.userList||0===n.userList.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.userList&&n.userList.length>0))},dependencies:[d.NgClass,d.NgForOf,d.NgIf,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.sg,o.u,b.V,g.N9,h.yS,d.DecimalPipe,d.DatePipe],styles:['.table[_ngcontent-%COMP%]   .no-commission-row[_ngcontent-%COMP%]{background-color:#fff2f0!important}.table[_ngcontent-%COMP%]   .no-commission-row[_ngcontent-%COMP%]:hover{background-color:#ffe7e6!important}.table[_ngcontent-%COMP%]   .no-commission-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{color:#262626!important;border-left:3px solid #ff7875!important}.table[_ngcontent-%COMP%]   .no-commission-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{position:relative}.table[_ngcontent-%COMP%]   .no-commission-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child:after{content:"No Commission";position:absolute;top:2px;right:2px;font-size:9px;color:#ff4d4f;background-color:#fff1f0;padding:1px 4px;border-radius:8px;border:1px solid #ffccc7;font-weight:600}.table[_ngcontent-%COMP%]   .commission-eligible-row[_ngcontent-%COMP%]{background-color:#f6fff6!important}.table[_ngcontent-%COMP%]   .commission-eligible-row[_ngcontent-%COMP%]:hover{background-color:#e6f7e6!important}.table[_ngcontent-%COMP%]   .commission-eligible-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{color:#262626!important;border-left:3px solid #52c41a!important}.no-commission-badge[_ngcontent-%COMP%]{display:block;font-size:10px;color:#ff4d4f;font-weight:600;margin-top:2px;background-color:#fff1f0;padding:2px 6px;border-radius:12px;border:1px solid #ffccc7;text-align:center;position:relative;z-index:2}.no-commission-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:2px;font-size:10px}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#fafafa;border-bottom:2px solid #f0f0f0;font-weight:600;color:#262626}.commission-legend[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:15px;padding:10px;background-color:#f8f9fa;border-radius:6px;border:1px solid #e9ecef}.commission-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:12px}.commission-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:3px;margin-right:6px;border:1px solid #d9d9d9}.commission-legend[_ngcontent-%COMP%]   .legend-item.no-commission[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{background-color:#fff2f0;border-color:#ff7875}.commission-legend[_ngcontent-%COMP%]   .legend-item.commission-eligible[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{background-color:#f6fff6;border-color:#52c41a}']}),r})()}];let ce=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[h.Bz.forChild(le),h.Bz]}),r})();var de=c(9668);let me=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[d.CommonModule,o.UX,de.v,C.A0,g.jF,ce]}),r})()}}]);