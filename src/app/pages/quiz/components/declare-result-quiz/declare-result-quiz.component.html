<div class="container-fluid">

  <app-page-title title="Declare Result" [breadcrumbItems]="breadCrumbItems"></app-page-title>

  <div class="row">
      <div class="col-xl-12">
          <div class="card">
              <div class="card-body">
                  <h5 class="card-title">Filter Quiz</h5>
                  <p class="card-title-desc"></p>
                  <form [formGroup]="getQuizFormGroup" >
                      <div class="row">
                        <div class="col-md-12">
                          <div class="mb-3">
                              <label>Select Recent Matches</label>
                              <ng-select formControlName="match_id" placeholder="Select Match" [items]="upcomingMatches" bindLabel="label" bindValue="match_id" ></ng-select>
                          </div>
                        </div>
                      </div>
                      <div>
                          <button type="submit" class="btn btn-primary w-md" [disabled]="!getQuizFormGroup.valid"  (click)="onSave()" >Submit</button>
                      </div>
                  </form>
              </div>
          </div>
      </div>
  </div>

  <div class="row" *ngIf="questionList.length !== 0">
    <div class="col-xl-12">
        <div class="card">
            <div class="card-body">
              <div class="card-header" >
                <div class="d-flex align-items-center">
                  <h5 class="mb-0 card-title flex-grow-1">Quiz List</h5>
                  <div class="flex-shrink-0 d-flex gap-1">
                    <button  class="btn btn-primary" [disabled]="finalizeBtn || finalize" (click)="finalizeResult()"  >Finalize Result</button>
                  </div>
                </div>
              </div>


                <p class="card-title-desc">
                  Total Marks : {{totalMarks}} / 100
                </p>
                <div class="table-responsive">
                  <table id="basic-datatable"
                    class="table table-bordered dt-responsive nowrap datatables no-footer dtr-inline">
                    <thead>
                      <tr>
                        <th>Question</th>
                        <th>A</th>
                        <th>B</th>
                        <th>C</th>
                        <th>D</th>
                        <th>Score</th>
                        <th>Answer</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container *ngFor="let question of questionList">
                        <tr>
                          <td>{{question.question}}</td>
                          <td>{{question.A}}</td>
                          <td>{{question.B}}</td>
                          <td>{{question.C}}</td>
                          <td>{{question.D}}</td>
                          <td>
                            <div class="input-group" *ngIf="question.marks == 0">
                              <select class="form-control"[(ngModel)]="question.marks" [disabled]="finalize" (change)="setMarks(question._id, $event.target)" >
                                <option value="">Select Result</option>
                                <option *ngFor="let marks of scoreMarks" [attr.value]="marks" >{{marks}}</option>
                              </select>
                            </div>
                            <span *ngIf="question.marks !== 0">{{question.marks}}</span>
                          </td>
                          <td>
                            <div class="input-group" >
                              <select class="form-control" [disabled]="finalize" [value]="question.result" id="inputGroupFileAddon004" [(ngModel)]="question.result" aria-describedby="inputGroupFileAddon004" *ngIf="question.type !== 'nearest'"  >
                                <option value=""  >Select Result</option>
                                <option value="A" *ngIf="question.type !== 'nearest'">A</option>
                                <option value="B" *ngIf="question.type !== 'nearest'">B</option>
                                <option value="C" *ngIf="question.type === '4options'">C</option>
                                <option value="D" *ngIf="question.type === '4options'">D</option>
                              </select>
                              <button class="btn btn-primary" type="button"  [disabled]="finalize" id="inputGroupFileAddon004" (click)="saveResult(question.result, question._id)"  *ngIf="question.type !== 'nearest'" >Confirm</button>
                            </div>
                            <div class="input-group" >
                              <input type="number" class="form-control"  [disabled]="finalize"  id="inputGroupFile04" aria-describedby="inputGroupFileAddon04" [(ngModel)]="question.result"  *ngIf="question.type === 'nearest'" >
                              <button class="btn btn-primary"  [disabled]="finalize" *ngIf="question.type === 'nearest'" type="button" id="inputGroupFileAddon04" (click)="saveResult(question.result, question._id)">Confirm</button>
                            </div>
                          </td>
                        </tr>
                      </ng-container>
                    </tbody>
                  </table>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

