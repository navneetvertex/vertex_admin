<div class="container-fluid">
    <app-page-title title="Receive Gift Card" [breadcrumbItems]="breadCrumbItems"></app-page-title>

    <div class="row">
            <div class="col-xl-12">
                <div class="card">
                    <div class="card-body" >
                        <div class="card-body border-bottom" >
                            <form [formGroup]="searchFormGroup" >
                                <div class="row">
                                    <div class="col-lg-4">
                                        <input type="search" class="form-control" id="searchInput" placeholder="Search for Name / User Id / Email id..." formControlName="name">
                                    </div>
                                    <div class="col-lg-3">
                                        <input type="search" class="form-control" id="searchDistributor" placeholder="Search for Distributor" formControlName="distributor">
                                    </div>

                                    <div class="col-lg-3" >
                                       <input type="date" class="form-control" id="searchInput" formControlName="transaction_date">
                                    </div>

                                    <div class="col-lg-1">
                                        <button (click)="getAllGifts()" type="button" class="btn btn-soft-secondary w-100"><i class="mdi mdi-filter-outline align-middle"></i> Filter</button>
                                    </div>
                                    <div class="col-lg-1" >
                                        <button (click)="refresh()" type="button" class="btn btn-soft-secondary w-100" class="btn btn-light"><i class="mdi mdi-refresh"></i></button>
                                    </div>
                                </div>
                          </form>
                      </div>
                        <div class="row">
                                <!-- Loading State -->
                                <div class="d-flex justify-content-center align-items-center" style="min-height: 150px;" *ngIf="isLoading">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                </div>

                                <!-- No Data State -->
                                <div class="d-flex flex-column justify-content-center align-items-center"  style="min-height: 150px;"  *ngIf="!isLoading && (!giftList || giftList.length === 0)">
                                    <img src="assets/img/not-found.png" width="300px" alt="">
                                    <p class="text-muted mt-2">No one received gift in the current filter.</p>
                                </div>

                                <!-- Data Table -->
                                <div class="table-responsive"  *ngIf="!isLoading && giftList.length !== 0">
                                    <table class="table table-bordered dt-responsive nowrap">
                                      <thead>
                                        <tr>
                                          <th>Sr No</th>
                                          <th>User</th>
                                          <th>Distributor</th>
                                          <th>Gift Name</th>
                                          <th>Quantity</th>
                                          <th>Transaction ID</th>
                                          <th>Date</th>
                                          <th>Status</th>
                                          <th>Notes</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr *ngFor="let receive of giftList; let i = index">
                                          <td>{{ (page - 1) * pageSize + i + 1 }}</td>
                                          <td>
                                            <div *ngIf="receive.user">
                                              <strong>{{receive.user.name}}</strong><br>
                                              <small>ID: {{receive.user.user_id}}</small><br>
                                              <small *ngIf="receive.user.email_id">{{receive.user.email_id}}</small>
                                            </div>
                                          </td>
                                          <td>
                                            <div *ngIf="receive.distributor">
                                              <strong>{{receive.distributor.name}}</strong><br>
                                              <small>ID: {{receive.distributor.distributor_id}}</small>
                                            </div>
                                          </td>
                                          <td>
                                            <div *ngIf="receive.gift">
                                              {{receive.gift.gift_name}}<br>
                                              <small>ID: {{receive.gift.gift_id}}</small>
                                            </div>
                                          </td>
                                          <td>{{receive.quantity}}</td>
                                          <td>{{receive.transaction_id}}</td>
                                          <td>{{receive.transaction_date | date: 'dd MMM yyyy, hh:mm a'}}</td>
                                          <td>
                                            <span class="badge"
                                                  [ngClass]="{
                                                    'bg-success': receive.status === 'Received',
                                                    'bg-warning': receive.status === 'Pending',
                                                    'bg-danger': receive.status === 'Rejected'
                                                  }">
                                              {{receive.status}}
                                            </span>
                                          </td>
                                          <td>
                                            <small>{{receive.notes || '-'}}</small>
                                          </td>
                                        </tr>
                                      </tbody>
                                    </table>
                                    <div class="row justify-content-md-between align-items-md-center mt-2">
                                      <div class="col-sm-12 col-md-5">
                                        <div class="dataTables_info mb-2" id="tickets-table_info" role="status" aria-live="polite">Showing
                                          <b>{{ (page - 1) * pageSize + 1 }}</b> to
                                          {{ findPageShowing() }} of {{ total }}
                                          entries
                                        </div>
                                      </div>
                                      <div class="col-sm-12 col-md-5">
                                        <div class="text-md-right float-md-end pagination-rounded">
                                          <ngb-pagination [collectionSize]="total" [(page)]="page" [pageSize]="pageSize" (pageChange)="pageChange($event)">
                                          </ngb-pagination>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                        </div>

                    </div>
                </div>
            </div>
    </div>


</div>
